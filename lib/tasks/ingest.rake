require 'csv'
require 'webservices/redcap_api'

# bundle exec rake data:truncate_omop_clinical_data_tables
# bundle exec rake ingest:data_dictionary
  # bundle exec rake ingest:data_dictionary_csv
# bundle exec rake ingest:omop_tables
# bundle exec rake ingest:maps
  # bundle exec rake ingest:maps_neurofiles
  # bundle exec rake ingest:maps_ccc19_pre_done
# bundle exec rake ingest:data
  # bundle exec rake ingest:insert_people
# bundle exec rake ingest:redcap2omop
namespace :ingest do
  desc "Data dictionary CSV"
  task(data_dictionary_csv: :environment) do  |t, args|
    redcap_project = RedcapProject.where(project_id: 0 , name: 'CCC19', api_import: false).first_or_create

    RedcapDataDictionary.delete_all
    RedcapEventMapDependent.delete_all
    RedcapEventMap.delete_all
    RedcapEvent.delete_all
    RedcapVariableChildMap.delete_all
    RedcapVariableChoiceMap.delete_all
    RedcapVariableChoice.delete_all
    RedcapVariable.delete_all
    RedcapVariableMap.delete_all
    RedcapVariableChoice.delete_all
    RedcapVariable.delete_all

    RedcapProject.not_deleted.csv_importable.all.each do |redcap_project|
      ActiveRecord::Base.transaction do
        redcap_data_dictionary = redcap_project.redcap_data_dictionaries.create

        file_name = 'CCC19_DataDictionary.csv'
        file_location = "#{Rails.root}/lib/setup/data/data_dictionaries/"
        data_dictionary = File.read("#{file_location}#{file_name}")
        data_dictionary[0]=''
        File.write("#{file_location}CCC19_DataDictionary_clean.csv", data_dictionary)

        data_dictionary_variables = CSV.new(File.open('lib/setup/data/data_dictionaries/CCC19_DataDictionary_clean.csv'), headers: true, col_sep: ",", return_headers: false,  quote_char: "\"")
        data_dictionary_variables.each do |data_dictionary_variable|
          redcap_variable = RedcapVariable.new(redcap_data_dictionary_id: redcap_data_dictionary.id)

          redcap_variable.name                  = data_dictionary_variable['Variable / Field Name']                         #metadata_variable['field_name']
          redcap_variable.form_name             = data_dictionary_variable['Form Name']                                     #metadata_variable['form_name']
          redcap_variable.field_type            = data_dictionary_variable['Field Type']                                    #metadata_variable['field_type']
          redcap_variable.text_validation_type  = data_dictionary_variable['Text Validation Type OR Show Slider Number']    #metadata_variable['text_validation_type_or_show_slider_number']
          redcap_variable.field_type_normalized = redcap_variable.normalize_field_type
          redcap_variable.field_label           = data_dictionary_variable['Field Label']                                   #metadata_variable['field_label']
          redcap_variable.choices               = data_dictionary_variable['Choices, Calculations, OR Slider Labels']       #metadata_variable['select_choices_or_calculations']
          redcap_variable.field_annotation      = data_dictionary_variable['Field Annotation']                              #metadata_variable['field_annotation']

          if redcap_variable.choices.present?
            redcap_variable.choices.split('|').each_with_index do |choice, i|
              choice_code, delimiter, choice_description = choice.partition(',')
              if choice_code.present?
                choice_code.strip!
              end

              if choice_description.present?
                choice_description.strip!
              end

              if redcap_variable.field_annotation.present?
                redcap_variable.field_annotation.strip!
              end

              redcap_variable.redcap_variable_choices.build(choice_code_raw: choice_code.try(:strip), choice_description: choice_description.try(:strip), vocabulary_id_raw: redcap_variable.field_annotation.try(:strip), ordinal_position: i)
            end
          end
          redcap_variable.save!
        end
      end
    end
  end

  desc "Data dictionary"
  task(data_dictionary: :environment) do |t, args|
    # redcap_project = RedcapProject.where(project_id: 5912, name: 'REDCap2SQL -- sandbox 2 - Longitudinal', api_token: '?', api_import: true).first_or_create

    RedcapDataDictionary.delete_all
    RedcapEventMapDependent.delete_all
    RedcapEventMap.delete_all
    RedcapEvent.delete_all
    RedcapVariableChildMap.delete_all
    RedcapVariableChoiceMap.delete_all
    RedcapVariableChoice.delete_all
    RedcapVariable.delete_all
    RedcapVariableMap.delete_all
    RedcapVariableChoice.delete_all
    RedcapVariable.delete_all

    RedcapProject.not_deleted.api_importable.all.each do |redcap_project|
      ActiveRecord::Base.transaction do
        redcap_webservice = Webservices::RedcapApi.new(api_token: redcap_project.api_token)

        redcap_data_dictionary = redcap_project.redcap_data_dictionaries.create
        load_redcap_events(redcap_webservice, redcap_data_dictionary)
        load_redcap_variables(redcap_webservice, redcap_data_dictionary)
      end
    end
  end

  desc "OMOP tables"
  task(omop_tables: :environment) do |t, args|
    OmopTable.delete_all
    OmopColumn.delete_all

    omop_table = OmopTable.new
    omop_table.name = Person.table_name
    omop_table.save!

    person_map_types = {}
    person_map_types['person_id'] = 'record_id'
    person_map_types['gender_concept_id'] = 'choice redcap variable'
    person_map_types['year_of_birth'] = 'date redcap variable year'
    person_map_types['month_of_birth'] = 'date redcap variable month'
    person_map_types['day_of_birth'] = 'date redcap variable month day'
    person_map_types['birth_datetime'] = 'date redcap variable month'
    person_map_types['race_concept_id'] = 'choice redcap variable'
    person_map_types['ethnicity_concept_id'] = 'choice redcap variable'
    person_map_types['location_id'] = 'skip'
    person_map_types['provider_id'] = 'skip'
    person_map_types['care_site_id'] = 'skip'
    person_map_types['person_source_value'] = 'record_id'
    person_map_types['gender_source_value'] = 'choice redcap variable choice description'
    person_map_types['gender_source_concept_id'] = 'skip'
    person_map_types['race_source_value'] = 'choice redcap variable choice description'
    person_map_types['race_source_concept_id'] = 'skip'
    person_map_types['ethnicity_source_value'] ='choice redcap variable choice description'
    person_map_types['ethnicity_source_concept_id'] ='skip'

    person = Person.new
    person.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = person.column_for_attribute(attribute).type
      omop_column.map_type = person_map_types[attribute]
      omop_column.save!
    end

    omop_table = OmopTable.new
    omop_table.name = Provider.table_name
    omop_table.save!
    provider_map_types = {}
    provider_map_types['provider_id'] = 'primary key'
    provider_map_types['provider_name'] = 'text redcap variable'
    provider_map_types['npi'] = 'text redcap variable'
    provider_map_types['dea'] = 'text redcap variable'
    provider_map_types['specialty_concept_id'] = 'choice redcap variable'
    provider_map_types['care_site_id'] = 'care_site'
    provider_map_types['year_of_birth'] = 'date redcap variable year'
    provider_map_types['gender_concept_id'] = 'choice redcap variable'
    provider_map_types['provider_source_value'] = 'text redcap variable'
    provider_map_types['specialty_source_value'] = 'choice redcap variable choice description'
    provider_map_types['specialty_source_concept_id'] = 'skip'
    provider_map_types['gender_source_value'] = 'choice redcap variable choice description'
    provider_map_types['gender_source_concept_id'] = 'skip'

    provider = Provider.new
    provider.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = provider.column_for_attribute(attribute).type
      omop_column.map_type = provider_map_types[attribute]
      omop_column.save!
    end

    #Observation
    omop_table = OmopTable.new
    omop_table.domain = Observation::DOMAIN_ID
    omop_table.name = Observation.table_name
    omop_table.save!

    observation_map_types = {}
    observation_map_types['observation_id'] = 'primary key'
    observation_map_types['person_id'] = 'person'
    observation_map_types['observation_concept_id'] = 'domain concept'
    observation_map_types['observation_date'] = 'date redcap variable'
    observation_map_types['observation_datetime'] = 'skip'
    observation_map_types['observation_type_concept_id'] = 'hardcode'
    observation_map_types['value_as_number'] = 'numeric redcap variable'
    observation_map_types['value_as_string'] = 'skip'
    observation_map_types['value_as_concept_id'] = 'choice redcap variable'
    observation_map_types['qualifier_concept_id'] = 'skip'
    observation_map_types['unit_concept_id'] = 'hardcode'
    observation_map_types['provider_id'] = 'provider'
    observation_map_types['visit_occurrence_id'] = 'visit_occurrence'
    observation_map_types['visit_detail_id'] = 'skip'
    observation_map_types['observation_source_value'] = 'redcap variable name'
    observation_map_types['observation_source_concept_id'] = 'skip'
    observation_map_types['unit_source_value'] = 'skip'
    observation_map_types['qualifier_source_value'] = 'skip'
    observation_map_types['value_source_value'] = 'redcap choice'

    observation = Observation.new
    observation.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = observation.column_for_attribute(attribute).type
      omop_column.map_type = observation_map_types[attribute]
      omop_column.save!
    end

    #Measurement
    omop_table = OmopTable.new
    omop_table.domain = Measurement::DOMAIN_ID
    omop_table.name = Measurement.table_name
    omop_table.save!

    measurement_map_types = {}
    measurement_map_types['measurement_id'] = 'primary key'
    measurement_map_types['person_id'] = 'person'
    measurement_map_types['measurement_concept_id'] = 'domain concept'
    measurement_map_types['measurement_date'] = 'date redcap variable'
    measurement_map_types['measurement_datetime'] = 'skip'
    measurement_map_types['measurement_time'] = 'skip'
    measurement_map_types['measurement_type_concept_id'] = 'hardcode'
    measurement_map_types['operator_concept_id'] = 'skip'
    measurement_map_types['value_as_number'] = 'numeric redcap variable'
    measurement_map_types['value_as_concept_id'] = 'choice redcap variable'
    measurement_map_types['unit_concept_id'] = 'skip'
    measurement_map_types['range_low'] = 'skip'
    measurement_map_types['range_high'] = 'skip'
    measurement_map_types['provider_id'] = 'provider'
    measurement_map_types['visit_occurrence_id'] = 'visit_occurrence'
    measurement_map_types['visit_detail_id'] = 'skip'
    measurement_map_types['measurement_source_value'] = 'redcap variable name|choice redcap variable choice description'
    measurement_map_types['measurement_source_concept_id'] = 'skip'
    measurement_map_types['unit_source_value'] = 'skip'
    measurement_map_types['value_source_value'] = 'skip'

    measurement = Measurement.new
    measurement.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = measurement.column_for_attribute(attribute).type
      omop_column.map_type = measurement_map_types[attribute]
      omop_column.save!
    end

    #CONDITION_OCCURRENCE
    omop_table = OmopTable.new
    omop_table.domain = ConditionOccurrence::DOMAIN_ID
    omop_table.name = ConditionOccurrence.table_name
    omop_table.save!

    condition_occrrence_map_types = {}
    condition_occrrence_map_types['condition_occurrence_id'] = 'primary key'
    condition_occrrence_map_types['person_id'] = 'person'
    condition_occrrence_map_types['condition_concept_id'] = 'domain concept'
    condition_occrrence_map_types['condition_start_date'] = 'date redcap variable|derived redcap date'
    condition_occrrence_map_types['condition_start_datetime'] = 'skip'
    condition_occrrence_map_types['condition_end_date'] = 'date redcap variable|derived redcap date'
    condition_occrrence_map_types['condition_end_datetime'] = 'skip'
    condition_occrrence_map_types['condition_type_concept_id'] = 'hardcode'
    condition_occrrence_map_types['stop_reason'] = 'skip'
    condition_occrrence_map_types['provider_id'] = 'provider'
    condition_occrrence_map_types['visit_occurrence_id'] = 'visit_occurrence'
    condition_occrrence_map_types['visit_detail_id'] = 'skip'
    condition_occrrence_map_types['condition_source_value'] = 'redcap variable name|choice redcap variable choice description'
    condition_occrrence_map_types['condition_source_concept_id'] = 'skip'
    condition_occrrence_map_types['condition_status_source_value'] = 'skip'
    condition_occrrence_map_types['condition_status_concept_id'] = 'skip'

    condition_occurrence = ConditionOccurrence.new
    condition_occurrence.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = condition_occurrence.column_for_attribute(attribute).type
      omop_column.map_type = condition_occrrence_map_types[attribute]
      omop_column.save!
    end

    #DEVICE_EXPOSURE
    omop_table = OmopTable.new
    omop_table.domain = DeviceExposure::DOMAIN_ID
    omop_table.name = DeviceExposure.table_name
    omop_table.save!

    device_exposure_map_types = {}
    device_exposure_map_types['device_exposure_id'] = 'primary key'
    device_exposure_map_types['person_id'] = 'person'
    device_exposure_map_types['device_concept_id'] = 'domain concept'
    device_exposure_map_types['device_exposure_start_date'] = 'date redcap variable|derived redcap date'
    device_exposure_map_types['device_exposure_start_datetime'] = 'skip'
    device_exposure_map_types['device_exposure_end_date'] = 'date redcap variable|derived redcap date'
    device_exposure_map_types['device_exposure_end_datetime'] = 'skip'
    device_exposure_map_types['device_type_concept_id'] = 'hardcode'
    device_exposure_map_types['unique_device_id'] = 'skip'
    device_exposure_map_types['quantity'] = 'skip'
    device_exposure_map_types['provider_id'] = 'provider'
    device_exposure_map_types['visit_occurrence_id'] = 'visit_occurrence'
    device_exposure_map_types['visit_detail_id'] = 'skip'
    device_exposure_map_types['device_source_value'] = 'redcap variable name|choice redcap variable choice description'
    device_exposure_map_types['device_source_concept_id'] = 'skip'

    device_exposure = DeviceExposure.new
    device_exposure.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = device_exposure.column_for_attribute(attribute).type
      omop_column.map_type = device_exposure_map_types[attribute]
      omop_column.save!
    end

    #PROCEDURE_OCCURENCE
    omop_table = OmopTable.new
    omop_table.domain = ProcedureOccurrence::DOMAIN_ID
    omop_table.name = ProcedureOccurrence.table_name
    omop_table.save!

    procedure_occurrence_map_types = {}
    procedure_occurrence_map_types['procedure_occurrence_id'] = 'primary key'
    procedure_occurrence_map_types['person_id'] = 'person'
    procedure_occurrence_map_types['procedure_concept_id'] = 'domain concept'
    procedure_occurrence_map_types['procedure_date'] = 'date redcap variable|derived redcap date'
    procedure_occurrence_map_types['procedure_datetime'] = 'skip'
    procedure_occurrence_map_types['procedure_type_concept_id'] = 'hardcode'
    procedure_occurrence_map_types['modifier_concept_id'] = 'skip'
    procedure_occurrence_map_types['quantity'] = 'skip'
    procedure_occurrence_map_types['provider_id'] = 'provider'
    procedure_occurrence_map_types['visit_occurrence_id'] = 'visit_occurrence'
    procedure_occurrence_map_types['visit_detail_id'] = 'skip'
    procedure_occurrence_map_types['procedure_source_value'] = 'redcap variable name|choice redcap variable choice description'
    procedure_occurrence_map_types['procedure_source_concept_id'] = 'skip'
    procedure_occurrence_map_types['modifier_source_value'] = 'skip'

    procedure_occurrence = ProcedureOccurrence.new
    procedure_occurrence.attributes.keys.each do |attribute|
      omop_column = OmopColumn.new
      omop_column.omop_table = omop_table
      omop_column.name = attribute
      omop_column.data_type = procedure_occurrence.column_for_attribute(attribute).type
      omop_column.map_type = procedure_occurrence_map_types[attribute]
      omop_column.save!
    end
  end

  desc "Maps neurofiless"
  task(maps_neurofiles: :environment) do |t, args|
    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox - CorePID').first
    redcap_project          = RedcapProject.where(project_id: 5840).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    RedcapVariableMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChoiceMap.joins(redcap_variable_choice: :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChildMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all

    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox -- PPA').first
    redcap_project          = RedcapProject.where(project_id: 5843).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    RedcapVariableMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChoiceMap.joins(redcap_variable_choice: :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChildMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all

    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox - SA').first
    redcap_project          = RedcapProject.where(project_id: 5844).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    RedcapVariableMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChoiceMap.joins(redcap_variable_choice: :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChildMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all

    map_core
    map_ppa
    map_sa
  end

  desc "Maps CCC19 pre-done"
  task(maps_ccc19_pre_done: :environment) do |t, args|
    redcap_project          = RedcapProject.where(name: 'CCC19').first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))

    RedcapVariableMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChoiceMap.joins(redcap_variable_choice: :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChildMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapDerivedDate.joins(:base_date_redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'record_id', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'person_source_value'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_derived_date
    base_date_redcap_variable = RedcapVariable.where(name: 'ts_0', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    base_date_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    base_date_redcap_variable.save!

    offset_redcap_variable = RedcapVariable.where(name: 'covid_19_dx_interval', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    redcap_variable_choices = {}
    redcap_variable_choices['Within the past week'] = 4
    redcap_variable_choices['Within the past 1 to 2 weeks'] = 11
    redcap_variable_choices['Within the past 2 to 4 weeks'] = 21
    redcap_variable_choices['Within the past 4 to 8 weeks'] = 42
    redcap_variable_choices['Within the past 8 to 12 weeks'] = 70
    redcap_variable_choices['Within the past 3 to 6 months'] = 135
    redcap_variable_choices['More than 6 months ago'] = 270
    redcap_variable_choices['Within the past 6 to 9 months'] = 225
    redcap_variable_choices['Within the past 9 to 12 months'] = 315
    redcap_variable_choices['More than 12 months ago'] = 450

    # name: 'COVID-19 Diagnosis'
    redcap_derived_date_diagnosis_covid19 = RedcapDerivedDate.where(base_date_redcap_variable: base_date_redcap_variable, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_covid19.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'inclusion_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'previous_report', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'this_registry', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'registry_other', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ccc19', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ccc19_exclude', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ccc19_exclude_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ccc19_institution', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'timing_of_report', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    #NCD latest phenotype
    #https://github.com/National-COVID-Cohort-Collaborative/Phenotype_Data_Acquisition/wiki/Latest-Phenotype
    redcap_variable = RedcapVariable.where(name: 'dx_year', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hcw_screen', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hcw_exclude', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'location', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'intl_stop', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # form "patient_demographics"
    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'local_id', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'patient_id', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # add support for derived numbers
    redcap_variable = RedcapVariable.where(name: 'age', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'peds_contact', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # add support for derived numbers
    redcap_variable = RedcapVariable.where(name: 'age_exact', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'gender', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'gender_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'F').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'M').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to say').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    # come back
    # figure out how to support tracking countries
    redcap_variable = RedcapVariable.where(name: 'country_of_patient_residen', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # figure out how to support tracking states
    redcap_variable = RedcapVariable.where(name: 'state_of_patient_residence', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # figure out how to support tracking cities
    redcap_variable = RedcapVariable.where(name: 'city', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'facility', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'more_demographics', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'race', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'race_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'American Indian/Alaska Native').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '1').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asian').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '2').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Native Hawaiian or Other Pacific Islander').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '4').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Black or African American').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '3').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'White').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '5').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown / Not Reported').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ethnicity', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'ethnicity_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic or Latino').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Hispanic').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'NOT Hispanic or Latino').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Not Hispanic').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown / Not Reported').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'urban_rural', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Urban (city)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '78153003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suburban (town, suburbs)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '62709005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rural (country)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '5794003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'insurance', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Private insurance/managed care').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '314847007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Medicare').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '433661000124107').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Medicaid').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '433641000124108').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not insured').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '424553001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other government').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    #https://github.com/OHDSI/Covid-19/wiki/Release
    redcap_variable = RedcapVariable.where(name: 'hcw', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'OMOP Extension', concept_code: 'OMOP4873944').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hcw_info', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ecog_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '0: Fully active, able to continue with all pre-disease activities without restriction').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '425389002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '1: Restricted in physically strenuous activity but ambulatory and able to carry out work of a light or sedentary nature, e.g., light house work, office work').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '422512005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '2: Ambulatory and capable of all self-care but unable to carry out any work activities. Up and about more than 50% of waking hours').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '422894000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '3: Capable of only limited self-care. Confined to bed or chair more than 50% of waking hours').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '423053003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '4: Completely disabled. Cannot carry on any self-care. Totally confined to bed or chair').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '423237006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'smoking_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Current smoker').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '65568007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Former smoker, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '160618006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Former smoker, quit less than 1 year ago').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '160618006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Former smoker, quit between 1 and 5 years ago').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '160618006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Former smoker, quit between 6 and 10 years ago').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '160618006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Former smoker, quit more than 10 years ago').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '160618006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Never smoker').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '8392000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap variable
    redcap_variable = RedcapVariable.where(name: 'smoking_product', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'device_exposure_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cigarettes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722496004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cigars').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722497008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'e-Cigarettes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722498003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hookah pipe').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722495000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'smoking_product_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # bad question
    # needs NLP

    redcap_variable = RedcapVariable.where(name: 'height', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # bad question
    # needs NLP
    redcap_variable = RedcapVariable.where(name: 'weight', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bmi', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: '39156-5').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'surg_med_hx_header', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # need to setup a derived date
    redcap_variable = RedcapVariable.where(name: 'recent_surgery', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'concomitant_meds', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ACE inhibitors').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C09A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Angiotensin receptor blockers (ARBs)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C09C').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anti-virals').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '44995').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antibiotics').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J01').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anticoagulation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antiplatelet agents other than aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1191').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azithromycin (Zithromax/Z-Pak)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chloroquine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2393').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydroxychloroquine (Plaquenil)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5521').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ibuprofen, naproxen, or other NSAIDs').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'M01A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Immunosuppressants').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lopinavir/Ritonavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J05AR10').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Metformin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '6809').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oseltamivir (Tamiflu)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '260101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Statins').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C10AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Systemic corticosteroids').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'H02').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tylenol (paracetamol/acetaminophen)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '161').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vitamin D').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '11253').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    # come back
    redcap_variable = RedcapVariable.where(name: 'steroid_specific_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # dependent variable
    redcap_variable = RedcapVariable.where(name: 'immuno_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Adalimumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '327361').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azathioprine (Imuran)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1256').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cyclophosphamide').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '3002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cyclosporine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '3008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Everolimus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '141704').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fedratinib (Inrebic)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2197490').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Mercaptopurine (6-MP)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '103').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Methotrexate').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '6851').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Mycophenolate mofetil (CellCept)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '265323').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ruxolitinib (Jakafi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1193326').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sirolimus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '35302').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tacrolimus (Prograf)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '42316').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vedolizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1538097').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'immuno_oth_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'aspirin_dose', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # dependent variable
    redcap_variable = RedcapVariable.where(name: 'bl_anticoag_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct factor Xa inhibitors (e.g., apixaban [Eliquis], rivaroxaban [Xarelto])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AF').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct thrombin inhibitors (e.g., argatroban, dabigatran [Pradaxa])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AE').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fondaparinux').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '321208').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Low-molecular weight heparin (e.g., enoxaparin [Lovenox])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AB').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unfractionated heparin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5224').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vitamin K antagonists (e.g., warfarin)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bl_anticoag_reason', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bl_anticoag_type_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bl_anticoag_type_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'meds_other', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # dependent variable
    redcap_variable = RedcapVariable.where(name: 'gcsf', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes, Prophylactic G-CSF use (within 1-3 days of completion of chemo)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '68442').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes, Therapeutic G-CSF use (later than 1-3 days after chemo or during a neutropenic hospitalization)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '68442').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'gcsf_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_meds', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # dependent variable
    # favor more specific
    redcap_variable = RedcapVariable.where(name: 'sars_vax', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # begin umls pending
    # dependent variable
    # redcap_variable = RedcapVariable.where(name: 'sars_vax_which', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    # redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    # redcap_variable.save!
    #
    # omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    # omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'AstraZeneca vaccine (both doses)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0022A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'AstraZeneca vaccine (one dose only)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0021A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Moderna mRNA vaccine (both doses)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0012A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Moderna mRNA vaccine (one dose only)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0011A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pfizer mRNA vaccine (both doses)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0002A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pfizer mRNA vaccine (one dose only)').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CPT4', concept_code: '0001A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!
    # end umls pending

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'sars_vax_when', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # dependent variable
    redcap_variable = RedcapVariable.where(name: 'influenza_vax', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CVX', concept_code: '141').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    # dependent variable
    redcap_variable = RedcapVariable.where(name: 'bcg_vax', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'CVX', concept_code: '19').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'blood_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'A').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '112144000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'AB').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '165743006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'B').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '112149005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'O').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '58460004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'blood_type_rh', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rh+').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '165747007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rh-').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '165746003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comorbid_header', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'significant_comorbidities', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Alcoholism').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '7200002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asthma').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '195967001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Atrial fibrillation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '49436004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'COPD/Emphysema').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '13645005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cardiac arrhythmia, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '698247007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cardiovascular disease, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '56265001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chronic renal insufficiency (CRI/CKD)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '723190009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cirrhosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '19943007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Congestive heart failure (CHF) including HFpEF and HFrEF').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '42343007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Coronary artery disease (CAD)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '53741008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Deep venous thrombosis (DVT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '128053003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Dementia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '52448006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Diabetes mellitus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '73211009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Diabetes mellitus with complications').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '190388001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ESRD, on dialysis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '236435004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'End-stage renal disease (ESRD), not on dialysis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '46177005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'HIV +/- AIDS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '62479008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'History of cerebrovascular accident (CVA; stroke)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '275526006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'History of hematopoietic transplant (bone marrow or stem cell)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '234336002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'History of solid organ transplant').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '313039003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hyperlipidemia (high cholesterol)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '55822004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hypertension (high blood pressure; HTN)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '38341003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ICI pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '427046006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Immune suppression (see definition)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '38013005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inflammatory bowel disease (IBD)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '24526004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Liver disease, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '235856003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Metabolic syndrome').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '237602007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Morbid obesity (BMI > 40 or BMI > 35 with obesity-related health conditions)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '238136002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Obesity').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414916001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Obstructive sleep apnea (OSA)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '78275009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Peripheral vascular disease (PVD/PAD)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '400047006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary disease, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '19829001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary embolism (PE)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '59282003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Radiation pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '84004001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Renal disease, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '90708001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rheumatologic/Autoimmune disease').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '85828009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Seasonal allergies').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '444316004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other organs and conditions').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hiv_cd4', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', concept_code: '413789001').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hiv_vl', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    other_redcap_variable = RedcapVariable.where(name: 'ts_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'unit_concept_id'").first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', concept_code: '395058002').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Unit', concept_code: '{copies}/mL').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ibd', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'please_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'o2_requirement', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes, patient requires chronic supplemental O2').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '57485005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No, patient does not require supplemental O2').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comorbid_no', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_comorbid', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comments_form_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #form covid19_details
    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ts_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_workup_why', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_workup_why_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'workup_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'symptoms', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Abdominal discomfort (other than frank abdominal pain)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '43364001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Abdominal pain').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '21522001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Altered mental status (AMS)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '419284004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'AArthralgias').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '57676002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cardiac involvement').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '301095005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Conjunctivitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '9826008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cough').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '49727002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Diarrhea').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '62315008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Dyspnea (SOB)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '267036007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fatigue/Malaise').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '367391008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fever').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '386661006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Headache').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '25064002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'LFT abnormalities').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '166643006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Loss of sense of smell (anosmia)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '44169009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Loss of taste (ageusia)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '36955009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Myalgias').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '68962001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nausea').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '422587007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None (patient was asymptomatic)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '84387000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Productive cough (with sputum)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '248595008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rhinorrhea').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '64531003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sore throat').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '162397003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vomiting').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '272044004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'symptoms_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'symptoms_none_why', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '243791004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_diagnosis', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Laboratory-confirmed').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'OMOP Extension', concept_code: 'OMOP4912978').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suspected based on CT scan findings)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '840544004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suspected based on CXR findings').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '840544004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suspected based on contact with confirmed case').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '840544004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suspected based on symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '840544004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_lab_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antigen test (ELISA)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: '94558-4').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: 'LA6576-8').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'OMOP Extension', concept_code: 'OMOP4873969').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: 'LA6576-8').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'PCR').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: '94746-5').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: 'LA6576-8').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Serology (antibodies to SARS-CoV-2)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: '94762-2').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: 'LA6576-8').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_dx_imaging', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'neg_test', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: '94558-4').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'LOINC', concept_code: 'LA6577-6').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_test_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_sx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    #https://forums.ohdsi.org/t/covid19-etl-help-for-converting-your-data-into-omop/10269/6
    redcap_variable = RedcapVariable.where(name: 'severity_of_covid_19_v2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '1300671000000104').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Mild (no hospitalization required)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '1300591000000101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Moderate (hospitalization indicated)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '1300571000000100').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Severe (ICU admission indicated)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '1300561000000107').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cytokine_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '710027002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hosp_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted directly to the ICU').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted to floor').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted to floor and then transferred to the ICU').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'code_status_admit', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'code_status_change', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'code_status_change_what', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'palliative_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hosp_los', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hosp_los_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'icu_los', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'current_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ER - Follow up').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'ER').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ER - new COVID-19 diagnosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'ER').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hospitalized (non-ICU)  - continued').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hospitalized (non-ICU) - new admit').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visti', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ICU - continued').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ICU - new admit').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - follow up').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - new COVID-19 diagnosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "None - patient is deceased").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'days_to_death_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: 'Death'
    redcap_derived_date_death = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'days_to_death_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_death, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable.save!

    # #redcap_variable
    # redcap_variable = RedcapVariable.where(name: 'cause_of_death', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    # redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable.save!
    #
    # omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'cause_concept_id'").first
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Both').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cause_of_death', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'cause_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Both').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'COVID-19').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cancer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '55342001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'deceased_reason', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_systemic', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bleeding').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '43364001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Disseminated intravascular coagulation (DIC)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '67406007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Multiorgan failure').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '57653000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sepsis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91302008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_bleeding', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CNS hemorrhage, extensive').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CNS hemorrhage, limited').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Major bleeding (requiring multiple RBCs transfusions or ICU admit)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '112648003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Minor bleed (without transfusion need)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '127563002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-major but clinically relevant bleed').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '73099002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_bleeding_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'dic_certainty', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Definite').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '67406007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Suspected').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'dic_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'device_exposure_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cryoprecipitate').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '256401009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma (FFP)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '346447007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'dic_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_comp_systemic_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'o2_requirement_c19', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '57485005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'o2_policy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_pulm', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute respiratory distress syndrome (ARDS)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '67782005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Empyema').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '312682007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pleural effusion').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '60046008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumonia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '233604007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '205237003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary embolism (PE)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '59282003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Respiratory failure').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '409622000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'resp_failure_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'BiPAP').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '425826004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CPAP').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '467645007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'High-flow nasal cannula or blow-by').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '426854004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Intubation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '447996002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nasal cannula or face mask with standard O2').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '336623009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-rebreather').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '427591007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'withdrawal_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'withdrawal_who', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'berlin_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'berlin_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_card', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Atrial fibrillation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '49436004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cardiomyopathy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '85898001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cerebrovascular accident (CVA; stroke)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Congestive heart failure (CHF)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '42343007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Deep venous thrombosis (DVT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '128053003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hypotension').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '45007003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Myocardial infarction').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '22298006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other cardiac arrhythmia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '698247007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other cardiac ischemia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414545008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary embolism (PE)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '59282003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Superficial venous thrombosis (SVT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '275517008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Thrombosis, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414086009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ventricular fibrillation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '71908006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'sepsis_pressors', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'H01BA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_comp_card_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_gi', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute hepatic injury').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '427044009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ascites').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '389026000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bowel obstruction').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '81060008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bowel perforation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '56905009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ileus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '710572000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Peritonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '48661000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_other', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute kidney injury').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '14669001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gangrene').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372070002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Seizures').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91175000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Thrombosis, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414086009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'days_to_death', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: 'Death 2'
    redcap_derived_date_death = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'days_to_death', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_death, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable.save!

    #redcap_variable
    # come back
    # condition status/discharge status/end date
    redcap_variable = RedcapVariable.where(name: 'current_status_v2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # condition status/discharge status/end date
    redcap_variable = RedcapVariable.where(name: 'current_status_retro', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # #redcap_variable
    # redcap_variable = RedcapVariable.where(name: 'cause_of_death_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    # redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable.save!
    #
    # omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'cause_concept_id'").first
    #
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Both').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cause_of_death_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'cause_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Both').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'COVID-19').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cancer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '55342001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'current_status_clinical', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    redcap_variable_date = RedcapVariable.where(name: 'ts_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, intubated').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, not requiring ventilator support').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Moderately ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Near Recovery').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Severely ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Mild symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Moderate symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - No symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Severe symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Other").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'worst_status_clinical', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    redcap_variable_date = RedcapVariable.where(name: 'ts_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first


    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, intubated').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, not requiring ventilator support').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: redcap_variable_date, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Moderately ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Near Recovery').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Severely ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Mild symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Moderate symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - No symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Severe symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Other").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'complications_severity', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'complications_severity_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'worst_complications_severity', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'worst_complications_severity_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'consider_returning', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'mortality', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '30 Day Survival'
    redcap_derived_date_30_day_survival = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Yes'] = 30

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_30_day_survival.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mortality', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_30_day_survival, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_30_day_survival, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "N/A - it has been fewer than 30 days since COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'mortality_90', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '90 Day Survival'
    redcap_derived_date_90_day_survival = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Yes'] = 90

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_90_day_survival.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mortality_90', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_survival, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_survival, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "N/A - it has been fewer than 90 days since COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'mortality_180', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '180 Day Survival'
    redcap_derived_date_180_day_survival = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Yes'] = 180

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_180_day_survival.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mortality_180', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_180_day_survival, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_180_day_survival, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "N/A - it has been fewer than 180 days since COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_variable
    # come back
    # we don't have enough data to derive most of these timepoints
    redcap_variable = RedcapVariable.where(name: 'labs', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'labs_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'wbc_range', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '391558003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "High").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '75540009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Low").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '62482003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'alc_range', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '74765001').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "High").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '75540009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Low").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '62482003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'anc_range', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '30630007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "High").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '75540009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Low").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '62482003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hgb_range', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '271026005').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "High").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '75540009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Low").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '62482003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'plt_range', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '61928009').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "High").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '75540009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Low").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '62482003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'wbc_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '391558003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: '10*9/L').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'alc', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '74765001').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: '/uL').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'anc', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '30630007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: '/uL').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'aec', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '71960002').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: '/uL').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hgb', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '271026005').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: 'g/dL').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'plt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '61928009').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'value_as_concept_id'").first
    redcap_variable.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'UCUM', concept_code: '10*3/uL').first.concept_id,  omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'creat', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '70901006').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'tbili', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '359986008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ast', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250641004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'alt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250637003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ldh', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250644007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'tni', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '29964007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hs_trop', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '121871002').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bnp', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '390917008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'crp', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '55235003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'il6', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '22766004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'pt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '396451008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'aptt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '409078003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'fibrinogen', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250346004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ddimer', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '103826007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Abnormal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '263654008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Normal").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '17621005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Not tested").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'other_lab', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'creat_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '70901006').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'tbili_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '359986008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ast_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250641004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'alt_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250637003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!


    # #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'pt_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '396451008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'aptt_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '409078003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'fibrinogen_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250346004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ddimer_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '103826007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ldh_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '250644007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'tni_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '29964007').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hs_trop_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '121871002').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bnp_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '390917008').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'crp_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '55235003').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    # redcap_variable
    redcap_variable = RedcapVariable.where(name: 'il6_numeric', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'SNOMED', concept_code: '22766004').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'other_lab_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'coinfection_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'coinfection', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aspergillus culture-confirmed').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '2429008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aspergillus suspected (galactomannan positive)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '709601002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bacterial infection, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '409822003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fungal, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '414561005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gram-negative bacteria, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gram-positive bacteria, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '8745002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Influenza A').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '407479009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Influenza B').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '407480007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ordinary coronavirus, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '84101006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumococcal pneumonia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '233607000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'RSV').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '6415009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rhinovirus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '1838001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Viral, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '49872002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tests are pending').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'coinfection_other', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrecne' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anticoagulation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antiplatelet agents other than aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antivirals').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '44995').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'N02BA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Atazanavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J05AE08').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azithromycin (Zithromax/Z-Pak)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bamlanivimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2463114').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Casirivimab/Imdevimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2465242').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chloroquine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2393').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Continuous renal replacement therapy (CRRT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '714749008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Extracorporeal membrane oxygenation (ECMO)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '233573008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydroxychloroquine (Plaquenil)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5521').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'JAK inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45861').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lopinavir/Ritonavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J05AR10').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oseltamivir (Tamiflu)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '260101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other interleukin inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other interleukin inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma from recovered individuals (convalescent plasma)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B05AX03').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Remdesivir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2284718').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Statins').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C10AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Systemic corticosteroids (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45523').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'TNF alpha inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AB').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'DEPRECATED').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_aspirin_dose', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'steroid_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Dexamethasone (Decadron)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '3264').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydrocortisone (Cortef)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5492').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Methylprednisolone (Solumedrol)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '6902').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prednisolone').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '8638').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prednisone').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '8640').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    # come back
    # more complexe than we can handle
    redcap_variable = RedcapVariable.where(name: 'steroid_specific', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'steroid_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'steroid_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_tx_interleukin', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sarilumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AC14').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'jak', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ruxolitinib (Jakafi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L01XE18').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Upadacitinib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AA44').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_reason', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_tx_tnf', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ruxolitinib (Jakafi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '214555').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_reason_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct factor Xa inhibitors (e.g., apixaban [Eliquis], rivaroxaban [Xarelto])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AF').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct thrombin inhibitors (e.g., argatroban, dabigatran [Pradaxa])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AE').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fondaparinux').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '321208').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Low-molecular weight heparin (e.g., enoxaparin [Lovenox])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AB').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unfractionated heparin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AB01').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vitamin K antagonists (e.g., warfarin)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_type_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_trial_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anti-virals').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '44995').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azithromycin (Zithromax/Z-Pak)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bamlanivimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2463114').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Canakinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '853491').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Casirivimab/Imdevimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2465242').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Guselkumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1928588').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydroxychloroquine (Plaquenil)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5521').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Infliximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '191831').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lopinavir/Ritonavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J05AR10').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma from recovered individuals (convalescent plasma)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B05AX03').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Remdesivir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2284718').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sarilumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1923319').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Systemic corticosteroids').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45523').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_trial_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap variable
    redcap_variable = RedcapVariable.where(name: 'prbc', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'device_exposure_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '431069006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comments_form_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #form cancer_details
    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ts_3', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'cancer_timing', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    #Assume 30 days per month
    #Assume 365 days per year
    redcap_variable_choices = {}
    redcap_variable_choices['AFTER the COVID-19 diagnosis'] = -30
    redcap_variable_choices['At the same time as COVID-19'] = 0
    redcap_variable_choices['More than 5 years ago'] = 1825
    redcap_variable_choices['Unknown'] = nil
    redcap_variable_choices['Within the past 5 years'] = 913
    redcap_variable_choices['Within the past year'] = 183

    # name: 'Cancer Diagnosis'
    redcap_derived_date_diagnosis_cancer = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_cancer.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variables = []
    redcap_variables << RedcapVariable.where(name: 'cancer_type', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variables << RedcapVariable.where(name: 'cancer_type_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variables << RedcapVariable.where(name: 'cancer_type_3', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variables << RedcapVariable.where(name: 'cancer_type_4', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variables << RedcapVariable.where(name: 'cancer_type_5', redcap_data_dictionary_id: redcap_data_dictionary.id).first

    redcap_variables.each do |redcap_variable|
      redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
      redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
      redcap_variable.save!

      omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'AL amyloidosis').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '23132008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute Leukemia').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91855006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute lymphoblastic leukemia (ALL)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91857003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute myeloid leukemia (AML)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91861009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Adrenocortical Carcinoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '2227007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aggressive lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '118600007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anal Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448315008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Appendix Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448992002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bile Duct Cancer (Cholangiocarcinoma)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '312104005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bladder Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '255108000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bone cancer, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448710000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain (CNS) Cancer, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372062007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain Cancer - benign (e.g., meningioma)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '92030004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain Cancer - high-grade glioma (e.g., GBM)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '393564001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain Cancer - low-grade glioma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '393564001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Breast Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254838004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Burkitt lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '118617000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cervical Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '285432005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chronic lymphocytic leukemia (CLL)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '277473004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chronic myeloid leukemia (CML)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '92818009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Colon Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '269533000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Colon/Rectum Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '781382000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Diffuse large B-cell lymphoma (DLBCL)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '109969005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Esophagus Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372138000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ewing Sarcoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '76909002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fallopian Tube Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '276870001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Follicular lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '277618009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'GIST').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '420120006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gallbladder Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372140005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Germ Cell Tumor').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '402878003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Head and Neck Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '255056009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Histiocyte disorder').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '127068004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hodgkin lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '118599009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ill Defined/Cancer of Unknown Primary').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '255052006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      #come back
      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Indolent lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '30440004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Invasive Cutaneous BCC (do not record localized BCC)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254701007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Invasive Cutaneous SCC (do not record localized SCC)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254651007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Liver Cancer (HCC)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '109841003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lung Cancer, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448993007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lymphoproliferative disorder').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '277466009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Malignant Hematologic Neoplasm, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '129154003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Malignant Solid Neoplasm, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '369757002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Mantle cell lymphoma (MCL)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '274905008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Marginal zone lymphoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '447100004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Melanoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372244006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Merkel Cell').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254729005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Mesothelioma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '62064005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Multiple myeloma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '109989006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Myelodysplastic syndrome (MDS)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '109995007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Myeloproliferative neoplasm (MPN)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '109993000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nasopharyngeal Carcinoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '449248000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Neuroblastoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '432328008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Neuroendocrine tumor (NET) or  Carcinoid').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '255046005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non Small Cell Lung Cancer (NSCLC)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254637007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-Hodgkin lymphoma (NHL)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '118601006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Osteosarcoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '21708004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ovarian Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '363443007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pancreatic Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372142002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Parathyroid Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '255037004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Penis Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: 'C9061').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Peritoneum Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '363492001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Placenta Cancer (incl. Choriocarcinoma)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '417570003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma cell dyscrasia').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '415111003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prostate Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254900004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rectum and Rectosigmoid Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '93984006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Renal Kidney Cancer (RCC)').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '702391001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Renal Pelvis Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '93985007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Retinoblastoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '370967009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rhabdomyosarcoma').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '302847003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Scrotum Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '126905005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Small Cell Lung Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254633006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Small Intestine Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448664009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Soft Tissue Sarcoma, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '449293008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Stomach (Gastric) Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '372143007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'T-cell and NK-cell neoplasm').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '422172005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Testis Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '713646001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Thymus Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '444231005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Thyroid Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '448216007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Uterus (Endometrial) Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254878006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vagina Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '254893005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vascular Sarcoma, NOS').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '93714009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vulva Cancer').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '447882007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Wilms Tumor').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '302849000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other Solid Tumor').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '369757002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other Solid Tumor').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '369757002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other Heme').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '129154003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '399981008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!

      redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
      redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
      redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
      redcap_variable_choice.save!
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_type_oth', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_type_oth_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_type_oth_3', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_type_oth_4', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_type_oth_5', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'acute_leukemia_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'lung_nos_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'teravolt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'multiple_ca', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: '"multiple_ca_quant"', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: '"multiple_ca_more"', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!


    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'breast_biomarkers', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'value_as_concept_id'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition' AND omop_columns.name = 'condition_start_date'").first

    # come back
    # hardcoing to ER positive because of silly 'OR'
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Estrogen and/or progesterone-receptor positive (ER or PR positive)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '23307004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '10828004').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'HER2 overexpressing (HER2 positive)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '784175006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'SNOMED', concept_code: '10828004').first.concept_id, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # probably should not be a Condition
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Triple-negative breast cancer (ER, PR, and HER2 negative)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '706970001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'bcg_intraves_ever', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '214555').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'gleason', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 2').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP5000329').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 3').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999224').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 4').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP5000253').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 5').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4997847').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 5').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4997847').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 6').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999573').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 7').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP5000187').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 8').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998543').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 9').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998481').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # missing from new Cancer Modifier vocabulary
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Gleason score 10').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No needle core biopsy/TURP/prostatectomy performed').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not applicable: Information not collected for this case').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'gleason_source', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # maybe use Episode
    redcap_variable = RedcapVariable.where(name: 'cancer_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hospice', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    redcap_variable_date = RedcapVariable.where(name: 'ts_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'CMS Place of Service', concept_code: '34').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'recent_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'recent_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    #Assume 30 days per month
    #Assume 365 days per year
    redcap_variable_choices = {}
    redcap_variable_choices['Less than 2 weeks prior to COVID-19 diagnosis'] = 14
    redcap_variable_choices['More than 3 months prior to COVID-19 diagnosis'] = 90
    redcap_variable_choices['More than 3 months prior to COVID-19 diagnosis'] = -14
    redcap_variable_choices['Unknown'] = nil
    redcap_variable_choices['Within 2 to 4 weeks prior to COVID-19 diagnosis'] = 21
    redcap_variable_choices['Within the month to 3 months prior to COVID-19 diagnosis'] = 60

    # name: 'Cancer Treatment'
    redcap_derived_date_treatment_cancer = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_cancer.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hx_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'treatment_modality', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cytotoxic chemotherapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '685').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Endocrine (Hormone) therapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '691').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Immunotherapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '694').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is not the right kind of semantic type
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Intravesicular therapy (e.g., BCG)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45215').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Radiotherapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '695').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Surgery').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '14051').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Surgery').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '14051').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is not the right kind of semantic type
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Targeted therapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '58229').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is not the right kind of semantic type
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Transplant/Cellular therapy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45186').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'intravesicular_bcg', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '5106').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'tx_modality_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'what_immunotherapy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anti-CTLA4 antibody').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '?').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anti-PD-1 antibody (e.g., nivolumab, pembrolizumab)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '?').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Combination of anti-CTLA4 and anti-PD-1 (e.g. ipilimumab & nivolumab)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '?').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!


    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'immuno_other_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'what_targeted_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acalabrutinib (Calquence)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '12460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Dasatinib (Sprycel)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '4853').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fedratinib (Inrebic)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '48563').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ibrutinib (Imbruvica)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '12027').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Imatinib (Gleevec)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '4907').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nilotinib (Tasigna)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '4852').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # this is why we need a cancer treatment ontology
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ruxolitinib (Jakafi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Regimen', vocabulary_id: 'HemOnc', concept_code: '1882').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'targeted_other_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'pneumonitis', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Definite irAE pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '205237003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Likely').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '205237003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'other_irae', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'irae_text', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # if we come up with a cancer treatment modifier vocabulary
    redcap_variable = RedcapVariable.where(name: 'radiotherapy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back

    redcap_variable = RedcapVariable.where(name: 'transplant_prior_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # this is all probably wrong
    # should go in Hemonc.org oncology treatment ontology
    redcap_variable = RedcapVariable.where(name: 'transplant_cellular_therapy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Allogeneic SCT (donor/type unknown)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '50223000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Autologous stem cell transplant').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '709115004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CAR-T cells').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'CPT4', concept_code: '0539T').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cord blood allogeneic SCT').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'HCPCS', concept_code: 'S2142').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Haplo allogeneic SCT').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: 'map_type:').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'MRD allogeneic SCT').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '50223000:').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'MUD allogeneic SCT').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '50223000:').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'sct_other_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'transplant_cellular_timing', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    #Assume 30 days per month
    #Assume 365 days per year
    redcap_variable_choices = {}
    redcap_variable_choices['0-20 days'] = 10
    redcap_variable_choices['101-365 days'] = 284
    redcap_variable_choices['21-100 days'] = 71
    redcap_variable_choices['During prep (prior to transplant)'] = 0
    redcap_variable_choices['More than 1 year'] = 395
    redcap_variable_choices['Unknown'] = nil

    # name: 'Cancer Stem Cell Treatment'
    redcap_derived_date_treatment_cancer = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_treatment_cancer, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_cancer.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'treatment_additional', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # this should be part of a standard treatment modifier vocabulary
    redcap_variable = RedcapVariable.where(name: 'treatment_intent', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # this should be part of a standard treatment modifier vocabulary
    redcap_variable = RedcapVariable.where(name: 'treatment_context', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # this should be part of a standard treatment modifier vocabulary
    redcap_variable = RedcapVariable.where(name: 'other_context', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'orchiectomy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    #Assume 30 days per month
    #Assume 365 days per year
    redcap_variable_choices = {}
    redcap_variable_choices['Yes'] = 180
    redcap_variable_choices['No'] = nil
    redcap_variable_choices['Unknown'] = nil

    # name: 'Orchiectomy Treatment'
    redcap_derived_date_treatment_orchiectomy_cancer = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_cancer.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    # come back
    # this is all probably wrong
    # should go in Hemonc.org oncology treatment ontology
    redcap_variable = RedcapVariable.where(name: 'orchiectomy', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '386633000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_orchiectomy_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'adt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!

    #Assume 30 days per month
    #Assume 365 days per year
    redcap_variable_choices = {}
    redcap_variable_choices['Yes'] = 180
    redcap_variable_choices['No'] = nil
    redcap_variable_choices['Unknown'] = nil

    # name: 'ADT Treatment'
    redcap_derived_date_treatment_adt_cancer = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_diagnosis_cancer.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    # come back
    # this is all probably wrong
    # should go in Hemonc.org oncology treatment ontology
    redcap_variable = RedcapVariable.where(name: 'adt', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '707266006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_orchiectomy_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'prostate_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Abiraterone (Zytiga)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1100072').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Apalutamide (Erleada)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1999574').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bicalutamide (Casodex)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '83008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cabazitaxel (Jevtana)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '996051').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Carboplatin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '40048').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Darolutamide (Nubeqa)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2180325').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Docetaxel (Taxotere)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '72962').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Enzalutamide (Xtandi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1307298').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Flutamide').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '4508').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nilutamide').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '31805').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Olaparib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1597582').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pembrolizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1547545').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pembrolizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1547545').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_treatment_cancer, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Radium-223').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1958200').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Clinical trial').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None of the above').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    # this is where a high-level treatment concept would be helpful
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other agent').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'prostate_trial_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'prostate_tx_oth', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'stage', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '0 (in situ)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999300').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Disseminated').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4997741').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'I').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999639').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'II').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999645').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'III').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999913').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'IV').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999934').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    #can't map
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Localized').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'stage_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mets_yn', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998856').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not applicable (e.g., patient has a liquid hematologic malignancy)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mets_sites', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'observation_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bone').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998978').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998538').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Brain').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998538').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Distant lymph nodes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998666').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Generalized metastases such as carcinomatosis, malignant pleural effusion, malignant ascites').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998856').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Liver').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP5000224').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lung').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4999962').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other sites').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Measurement', vocabulary_id: 'Cancer Modifier', concept_code: 'OMOP4998856').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'mets_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'clinical_trial', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '110465008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'clinical_trial_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_ca_dx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # no timing information at all
    redcap_variable = RedcapVariable.where(name: 'prior_tx', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'drugs_expanded', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'irae_gr3', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Arthralgia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '112144000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Arthritis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '3723001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Colitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '64226004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Diarrhea').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '267060006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Enteritis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '64613007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hepatitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '128241005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hypothyroidism').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '40930008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '205237003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pruritis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '418290006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Rash').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '271807003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_cancer, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'irae_oth_specify', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    #come back
    # does this not duplicate irae_gr3
    redcap_variable = RedcapVariable.where(name: 'irae_past', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'irae_past_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'prior_tx_other', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'prior_tx_text', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comments_form_3', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ts_4', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'role', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'practice_setting', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'role_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'other_role', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'email_1', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comments_form_4', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ts_5', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'fu_weeks', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: 'Followup 1'
    redcap_derived_date_followup_1 = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['All other time intervals'] = nil
    redcap_variable_choices['Approximately 180 days after COVID-19 diagnosis'] = 180
    redcap_variable_choices['Approximately 30 days after COVID-19 diagnosis'] = 30

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_followup_1.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'd30_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '30 Day Vital Status'
    redcap_derived_date_30_day_vital_status = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Patient was deceased within 30 days of COVID-19 diagnosis'] = 15
    redcap_variable_choices['Unknown'] = nil
    redcap_variable_choices['Yes the patient was alive for at least 30 days from COVID-19 diagnosis'] = 30
    redcap_variable_choices['Yes the patient was alive for at least 30 days from COVID-19 diagnosis'] = 30

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_30_day_vital_status.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'd30_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Patient was deceased within 30 days of COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_survival, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes the patient was alive for at least 30 days from COVID-19 diagnosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_30_day_vital_status, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_30_day_vital_status, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'd90_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '90 Day Vital Status'
    redcap_derived_date_90_day_vital_status = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Patient was deceased within 90 days of COVID-19 diagnosis'] = 30
    redcap_variable_choices['Unknown'] = nil
    redcap_variable_choices['Yes the patient was alive for at least 90 days from COVID-19 diagnosis'] = 90

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_90_day_vital_status.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'd90_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Patient was deceased within 90 days of COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_vital_status, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes the patient was alive for at least 90 days from COVID-19 diagnosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_vital_status, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_90_day_vital_status, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'd180_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: '180 Day Vital Status'
    redcap_derived_date_180_day_vital_status = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable).first_or_create

    redcap_variable_choices = {}
    redcap_variable_choices['Patient was deceased within 180 days of COVID-19 diagnosis'] = 90
    redcap_variable_choices['Unknown'] = nil
    redcap_variable_choices['Yes the patient was alive for at least 180 days from COVID-19 diagnosis'] = 180

    redcap_variable_choices.each do |k,v|
      redcap_variable_choice = RedcapVariableChoice.where(redcap_variable_id: offset_redcap_variable.id, choice_description: k).first
      redcap_derived_date_180_day_vital_status.redcap_derived_date_choice_offset_mappings.build(redcap_variable_choice: redcap_variable_choice,  offset_days: v)
    end

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'd180_vital_status', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Patient was deceased within 180 days of COVID-19 diagnosis").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_180_day_vital_status, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes the patient was alive for at least 180 days from COVID-19 diagnosis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_180_day_vital_status, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_180_day_vital_status, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'timing_of_report_weeks', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'fu_reason', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'fu_reason_oth', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'timing_of_report_weeks', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    offset_redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    offset_redcap_variable.save!
    # name: 'Followup 2'
    redcap_derived_date_followup_2 = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable, offset_redcap_variable_numeric_interval_days: 7).first_or_create

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_status_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fully recovered').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ongoing infection').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Recovered with complications').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Died').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # redcap_derived_date
    offset_redcap_variable = RedcapVariable.where(name: 'days_to_death_fu_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    # name: 'Death 2'
    redcap_derived_date_death_2 = RedcapDerivedDate.where(parent_redcap_derived_date: redcap_derived_date_diagnosis_covid19, offset_redcap_variable: offset_redcap_variable, offset_redcap_variable_numeric_interval_days: 1).first_or_create

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'days_to_death_fu_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Type Concept', vocabulary_id: 'Death Type', concept_code: 'OMOP4822229').first.concept_id , map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'death_date'").first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_death_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cause_of_death_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'death' AND omop_columns.name = 'cause_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Both').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'COVID-19').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '840539006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cancer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '55342001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'deceased_reason_fu_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # can't find a map
    redcap_variable = RedcapVariable.where(name: 'who_ordinal_scale', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'who_ordinal_oth', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'current_status_clinical_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, intubated').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Critical (ICU) - Severely ill, not requiring ventilator support').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Moderately ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Near Recovery').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Inpatient - Severely ill').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Mild symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Moderate symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - No symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Outpatient - Severe symptoms').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Other").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'current_status_clinical_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # can't find a map
    redcap_variable = RedcapVariable.where(name: 'worst_complications_severity_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # can't find a map
    redcap_variable = RedcapVariable.where(name: 'complications_severity_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'complications_severity_oth_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_tx_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'cancer_tx_fu_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # maybe use Episode
    redcap_variable = RedcapVariable.where(name: 'cancer_status_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hospice_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first
    redcap_variable_date = RedcapVariable.where(name: 'ts_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'CMS Place of Service', concept_code: '34').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hospice_fu_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hosp_status_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'visit_occurrence' AND omop_columns.name = 'visit_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not applicable - they were admitted to the hospital at the time of the last report and remain hospitalized').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted directly to the ICU').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted to floor and then transferred to the ICU').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'OMOP4822460').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes - admitted to floor for the duration of the illness').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Visit', vocabulary_id: 'Visit', concept_code: 'IP').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Other").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hosp_status_fu_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'admission_reason_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # maybe derived date
    redcap_variable = RedcapVariable.where(name: 'hosp_los_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # maybe derived date
    redcap_variable = RedcapVariable.where(name: 'hosp_los_fu_2', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    # come back
    # maybe derived date
    redcap_variable = RedcapVariable.where(name: 'icu_los_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'current_status_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bleeding').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '43364001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Disseminated intravascular coagulation (DIC)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '67406007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Multiorgan failure').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '57653000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Sepsis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '91302008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No additional systemic events').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_bleeding_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CNS hemorrhage, extensive').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CNS hemorrhage, limited').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Major bleeding (requiring multiple RBCs transfusions or ICU admit)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '112648003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Minor bleed (without transfusion need)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '127563002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-major but clinically relevant bleed').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '73099002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_bleeding_oth_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'dic_more_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_comp_systemic_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'o2_requirement_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '57485005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_pulm_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute respiratory distress syndrome (ARDS)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '67782005').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Empyema').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '312682007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pleural effusion').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '60046008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumonia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '233604007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pneumonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '205237003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary embolism (PE)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '59282003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Respiratory failure').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '409622000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'resp_failure_tx_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrence' AND omop_columns.name = 'procedure_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'BiPAP').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '425826004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'CPAP').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '467645007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'High-flow nasal cannula or blow-by').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '426854004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Intubation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '447996002').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Nasal cannula or face mask with standard O2').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '336623009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-rebreather').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '427591007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'berlin_yn_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'berlin_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_comp_pulm_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_card_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Atrial fibrillation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '49436004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cardiomyopathy').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '85898001').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cerebrovascular accident (CVA; stroke)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '230690007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Congestive heart failure (CHF)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '42343007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Deep venous thrombosis (DVT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '128053003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hypotension').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '45007003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Myocardial infarction').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '22298006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other cardiac arrhythmia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '698247007').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other cardiac ischemia').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414545008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Pulmonary embolism (PE)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '59282003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Superficial venous thrombosis (SVT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '275517008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Thrombosis, NOS').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '414086009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ventricular fibrillation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '71908006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'hotn_pressors_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'H01BA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_comp_card_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_gi_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'condition_occurrence' AND omop_columns.name = 'condition_start_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Acute hepatic injury').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '427044009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ascites').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '389026000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bowel obstruction').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '81060008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bowel perforation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '56905009').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ileus').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '710572000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Peritonitis').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '48661000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_complications_oth_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_addl_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_addl_treatment', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'additional_tx_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_treatment_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first
    omop_column_3 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'procedure_occurrecne' AND omop_columns.name = 'procedure_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anticoagulation').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01A').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antiplatelet agents other than aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Antivirals').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '44995').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Aspirin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'N02BA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azithromycin (Zithromax/Z-Pak)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bamlanivimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2463114').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Casirivimab/Imdevimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2465242').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chloroquine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2393').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Continuous renal replacement therapy (CRRT)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '714749008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Extracorporeal membrane oxygenation (ECMO)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Procedure', vocabulary_id: 'SNOMED', concept_code: '233573008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_3, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydroxychloroquine (Plaquenil)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5521').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'JAK inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45861').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lopinavir/Ritonavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'J05AR10').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oseltamivir (Tamiflu)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '260101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other interleukin inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other interleukin inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AC').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma from recovered individuals (convalescent plasma)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B05AX03').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Remdesivir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2284718').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Statins').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C10AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Systemic corticosteroids (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45523').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'TNF alpha inhibitors (will prompt for additional details)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'L04AB').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'DEPRECATED').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'None').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'steroid_type_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Dexamethasone (Decadron)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '3264').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydrocortisone (Cortef)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5492').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Methylprednisolone (Solumedrol)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '6902').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prednisolone').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '8638').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prednisone').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '8640').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    # come back
    redcap_variable = RedcapVariable.where(name: 'steroid_specific_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'steroid_more_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_aspirin_dose_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_type_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct factor Xa inhibitors (e.g., apixaban [Eliquis], rivaroxaban [Xarelto])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AF').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Direct thrombin inhibitors (e.g., argatroban, dabigatran [Pradaxa])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AE').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fondaparinux').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '321208').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Low-molecular weight heparin (e.g., enoxaparin [Lovenox])').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AB').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unfractionated heparin').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AB01').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Vitamin K antagonists (e.g., warfarin)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B01AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_type_oth_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_reason_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'c19_anticoag_reason_oth_specify_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_tx_interleukin_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'anakinra').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '72435').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'basiliximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '196102').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'briakinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '847083').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'canakinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '853491').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'daclizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '190353').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'guselkumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1928588').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ixekizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1745099').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'rilonacept').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '763450').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'risankizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2166040').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'sarilumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1923319').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'secukinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1599788').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'siltuximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1535218').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    # can't find a map
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'sirukumab').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1535218').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'tildrakizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2053436').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ustekinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '847083').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'DEPRECATED').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'jak_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Baricitinib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2047232').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Fedratinib (Inrebic)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2197490').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oclacitinib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1487006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Peficitinib').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1487006').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Ruxolitinib (Jakafi)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1193326').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Tofacitinib (Xeljanz)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1357536').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Upadacitinib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2196092').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_tx_tnf_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Adalimumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '327361').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Afelimomab').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '327361').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Certolizumab pegol').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '709271').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Etanercept').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '214555').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Golimumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '819300').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Infliximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '191831').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Opinercept').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '191831').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_diagnosis_covid19, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_treatment_trial_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!


    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_trial_tx_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_start_date'").first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'drug_exposure' AND omop_columns.name = 'drug_exposure_end_date'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Anti-virals').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '44995').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Atazanavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Azithromycin (Zithromax/Z-Pak)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '18631').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Bamlanivimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2463114').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Baricitinib').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2047232').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Casirivimab/Imdevimab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2465242').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chloroquine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2393').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Chloroquine').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2393').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hydroxychloroquine (Plaquenil)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '5521').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Lopinavir/Ritonavir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '195088').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oseltamivir (Tamiflu)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '260101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Oseltamivir (Tamiflu)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '260101').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Plasma from recovered individuals (convalescent plasma)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'B05AX03').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED


    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Remdesivir').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2284718').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Statins').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'ATC', concept_code: 'C10AA').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Systemic corticosteroids').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'HemOnc', concept_code: '45523').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'adalimumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '327361').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'afelimomab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '327361').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'anakinra').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '72435').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'basiliximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '196102').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    # come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'briakinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '196102').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'brodalumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1872251').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'canakinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '853491').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'certolizumab pegol').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '709271').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'daclizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '190353').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'etanercept').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '214555').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'golimumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '819300').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'guselkumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1928588').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'infliximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '191831').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ixekizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1745099').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'opinercept').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '?').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'rilonacept').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '763450').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'risankizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2166040').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'sarilumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1923319').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'secukinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1599788').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'siltuximab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '1535218').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #come back
    # redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'sirukumab').first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '?').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    # redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    # redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'tildrakizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '2053436').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'tocilizumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '612865').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'ustekinumab').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Drug', vocabulary_id: 'RxNorm', concept_code: '847083').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_derived_date: redcap_derived_date_followup_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_DERIVED_DATE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'covid_19_trial_more_fu', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'comments_form_5', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'manual_exclude', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'exclude_why', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'manual_exclude_more', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
    redcap_variable.save!
  end

  # #redcap_variable
  # redcap_variable = RedcapVariable.where(name: 'comorbid_header', redcap_data_dictionary_id: redcap_data_dictionary.id).first
  # redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_SKIPPED
  # redcap_variable.save!

  #keep going
  desc "Maps"
  task(maps: :environment) do |t, args|
    redcap_project          = RedcapProject.where(name: 'REDCap2SQL -- sandbox 2 - Longitudinal').first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))

    RedcapVariableMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChoiceMap.joins(redcap_variable_choice: :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all
    RedcapVariableChildMap.joins(:redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id).destroy_all

    #patient
    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'record_id', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'person_source_value'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'gender', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'gender_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cis Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'F').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cis Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'M').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Trans Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Transe Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Non-binary').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'dob', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'birth_datetime'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'race', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'race_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'American Indian or Alaska Native').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '1').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asian').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '2').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Black or African American').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '3').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic or Latino').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Native Hawaiian or Other Pacific Islander').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '4').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'White').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '5').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'ethnicity', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'ethnicity_concept_id'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic or Latino').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Hispanic').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not Hispanic or Latino').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Not Hispanic').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #provider
    #redcap_variable
    redcap_variable = RedcapVariable.where(name: 'v_coordinator', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.build_redcap_variable_map(omop_column_id: omop_column.id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_COLUMN)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    #redcap_variable
    #moca
    redcap_variable = RedcapVariable.where(name: 'moca', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: '72172-0').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_d').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_coordinator').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap_variable
    #mood
    redcap_variable = RedcapVariable.where(name: 'mood', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: '66773-3').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_d').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_coordinator').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap_variable
    #clock_position_of_wound
    redcap_variable = RedcapVariable.where(name: 'clock_position_of_wound', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(concept_id: Concept.where(domain_id: 'Measurement', concept_code: '72297-5').first.concept_id, map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 o'clock").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', concept_code: 'LA19054-8').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "11 o'clock").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', concept_code: 'LA19057-1').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "12 o'clock").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', concept_code: 'LA19055-5').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 o'clock").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', concept_code: 'LA19053-0').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 o'clock").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', concept_code: 'LA19056-3').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_d', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'measurement_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    other_redcap_variable = RedcapVariable.where(name: 'v_coordinator', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'measurement' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable.save!

    #redcap variable
    # hcw
    redcap_variable = RedcapVariable.where(name: 'hcw', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Yes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'OMOP Extension', concept_code: 'OMOP4873944').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    other_redcap_variable_1 = RedcapVariable.where(name: 'v_d', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_1, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    other_redcap_variable_2 = RedcapVariable.where(name: 'v_coordinator', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_2, omop_column: omop_column, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'No').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    #redcap variable
    # smoking_product
    # redcap_data_dictionary = RedcapDataDictionary.first
    redcap_variable = RedcapVariable.where(name: 'smoking_product', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    redcap_variable.build_redcap_variable_map(map_type: RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE)
    redcap_variable.curation_status = RedcapVariable::REDCAP_VARIABLE_CURATION_STATUS_MAPPED
    redcap_variable.save!

    other_redcap_variable_1 = RedcapVariable.where(name: 'v_d', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column_1 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'device_exposure_start_date'").first
    other_redcap_variable_2 = RedcapVariable.where(name: 'v_coordinator', redcap_data_dictionary_id: redcap_data_dictionary.id).first
    omop_column_2 = OmopColumn.joins(:omop_table).where("omop_tables.name = 'device_exposure' AND omop_columns.name = 'provider_id'").first

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cigarettes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722496004').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_1, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Cigars').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722497008').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_1, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'e-Cigarettes').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722498003').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_1, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hookah pipe').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Device', vocabulary_id: 'SNOMED', concept_code: '722495000').first.concept_id, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_1, omop_column: omop_column_1, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable_2, omop_column: omop_column_2, map_type: RedcapVariableChildMap::REDCAP_VARIABLE_CHILD_MAP_MAP_TYPE_REDCAP_VARIABLE)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0, map_type: RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
    redcap_variable_choice.curation_status = RedcapVariableChoice::REDCAP_VARIABLE_CHOICE_CURATION_STATUS_MAPPED
    redcap_variable_choice.save!
  end

  desc "Load REDCap records"
  task(data: :environment) do |t, args|
    RedcapProject.not_deleted.api_importable.all.each do |redcap_project|
      ActiveRecord::Base.transaction do
        redcap_webservice = Webservices::RedcapApi.new(api_token: redcap_project.api_token)
        records     = redcap_webservice.records
        field_names = records.first.keys
        refresh_redcap_export_table(redcap_project.export_table_name, field_names)
        load_redcap_records(redcap_project.export_table_name, records)
      end
    end
  end

  desc "Insert people"
  task(insert_people: :environment) do |t, args|
    person = Person.new
    person.person_id = Person.next_id
    person.gender_concept_id = 0
    person.birth_datetime = DateTime.parse('1976-10-14')
    person.race_concept_id = 0
    person.ethnicity_concept_id = 0
    person.person_source_value = 'abc123'
    person.save!
  end

  desc "REDCap2OMOP"
  task(redcap2omop: :environment) do |t, args|
    redcap_project = RedcapProject.where(name: 'REDCap2SQL -- sandbox 2 - Longitudinal').first
    redcap_project.route_to_observation = false
    redcap_project.insert_person        = true
    redcap_project.complete_instrument  = true
    redcap_project.save!

    if redcap_project.insert_person
      Person.delete_all
    end
    Provider.delete_all
    Observation.delete_all
    RedcapSourceLink.delete_all

    RedcapProject.not_deleted.api_importable.all.each do |redcap_project|
      puts 'Start this project:'
      puts redcap_project.name
      person_redcap2omop_map = {}
      redcap_data_dictionary = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
      redcap_variables_by_omop_table('person', redcap_data_dictionary).each do |redcap_variable_map|
        person_redcap2omop_map[redcap_variable_map.omop_column.name] = redcap_variable_map.redcap_variable.name
      end

      provider_redcap2omop_map = {}
      redcap_variables_by_omop_table('provider', redcap_data_dictionary).each do |redcap_variable_map|
        provider_redcap2omop_map[redcap_variable_map.omop_column.name] ||= []
        hash = { source: redcap_variable_map.redcap_variable.name }
        redcap_variable_map.redcap_variable.redcap_variable_child_maps.each do |redcap_variable_child_map|
          hash[:variable_children] ||= []
          hash[:variable_children] << { redcap_variable_child_map.omop_column.name => redcap_variable_child_map.redcap_variable.name }
        end
        provider_redcap2omop_map[redcap_variable_map.omop_column.name] << hash
      end
      # puts provider_redcap2omop_map.inspect

      redcap_records = ActiveRecord::Base.connection.select_all("select * from #{redcap_project.export_table_name}").to_a

      redcap_records.each do |redcap_export_tmp|
        if redcap_project.insert_person
          #person
          if redcap_export_tmp[person_redcap2omop_map['birth_datetime']].present? || redcap_export_tmp[person_redcap2omop_map['year_of_birth']].present?
            puts redcap_export_tmp[person_redcap2omop_map['person_source_value']]
            person = Person.where(person_source_value: redcap_export_tmp[person_redcap2omop_map['person_source_value']]).first

            unless person.present?
              person = Person.new
              person.person_id = Person.next_id

              person.person_source_value = redcap_export_tmp[person_redcap2omop_map['person_source_value']]
              puts 'redcap: gender_concept_id'
              puts redcap_export_tmp[person_redcap2omop_map['gender_concept_id']]
              puts 'omop: gender_concept_id'
              redcap_variable = RedcapVariable.where(name: person_redcap2omop_map['gender_concept_id'], redcap_data_dictionary_id: redcap_data_dictionary.id).first
              if redcap_variable
                gender_concept_id = redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                if gender_concept_id.present?
                  person.gender_concept_id = gender_concept_id
                end
              end

              if redcap_export_tmp[person_redcap2omop_map['birth_datetime']].present?
                puts 'redcap: birth_datetime'
                puts redcap_export_tmp[person_redcap2omop_map['birth_datetime']]
                puts DateTime.parse(redcap_export_tmp[person_redcap2omop_map['birth_datetime']])
                person.birth_datetime = DateTime.parse(redcap_export_tmp[person_redcap2omop_map['birth_datetime']])
              end

              if redcap_export_tmp[person_redcap2omop_map['year_of_birth']].present?
                puts 'redcap: year_of_birth'
                puts redcap_export_tmp[person_redcap2omop_map['birth_year']]
                puts redcap_export_tmp[person_redcap2omop_map['year_of_birth']]
                person.year_of_birth = redcap_export_tmp[person_redcap2omop_map['year_of_birth']]
              end

              puts 'redcap: race_concept_id'
              puts redcap_export_tmp[person_redcap2omop_map['race_concept_id']]
              puts 'omop: race_concept_id'
              redcap_variable = RedcapVariable.where(name: person_redcap2omop_map['race_concept_id'], redcap_data_dictionary_id: redcap_data_dictionary.id).first
              if redcap_variable.present?
                puts redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                person.race_concept_id = redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
              end

              puts 'redcap: ethnicity_concept_id'
              puts redcap_export_tmp[person_redcap2omop_map['ethnicity_concept_id']]
              puts 'omop: ethnicity_concept_id'
              redcap_variable = RedcapVariable.where(name: person_redcap2omop_map['ethnicity_concept_id'], redcap_data_dictionary_id: redcap_data_dictionary.id).first
              if redcap_variable.present?
                puts redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                person.ethnicity_concept_id = redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
              end

              if person.valid?
                puts 'we are creating this person'
                puts redcap_export_tmp[person_redcap2omop_map['person_source_value']]
                person.save!
              else
                puts 'we are not creating this person'
                puts redcap_export_tmp[person_redcap2omop_map['person_source_value']]
                puts person.errors.full_messages
              end
            end
          end
        end

        # puts provider_redcap2omop_map.inspect
        #provider
        provider_redcap2omop_map['provider_source_value'].each do |provider_source_value_hash|
          # puts provider_source_value_hash.inspect
          provider_source_value_column = provider_source_value_hash[:source]
          # puts "provider_source_value_column: #{provider_source_value_column.inspect}"
          provider_source_value = redcap_export_tmp[provider_source_value_column]
          # puts "provider_source_value: #{provider_source_value.inspect}"
          provider_name_source  = provider_source_value_hash[:variable_children].detect{|c| c.keys.include?('provider_name')}
          # puts "provider_name_source: #{provider_name_source}"
          if provider_source_value.present?
            provider = Provider.where(provider_source_value: provider_source_value).first
            unless provider.present?
              provider = Provider.new
              provider.provider_id = Provider.next_id
              provider.provider_source_value = provider_source_value
              provider.provider_name = redcap_export_tmp[provider_name_source['provider_name']]
              provider.save!
              puts "Created #{provider.inspect} provider"
            end
          end
        end
      end

      #domain_redcap_variable_choice
      domain_redcap_variable_choice_maps = redcap_variable_choice_maps_in_omop_domains(redcap_data_dictionary)
      puts 'how many domain_redcap_variable_choice_maps'
      puts domain_redcap_variable_choice_maps.size
      redcap_records.each do |redcap_export_tmp|
        puts redcap_export_tmp[person_redcap2omop_map['person_source_value']].inspect
        person = Person.where(person_source_value: redcap_export_tmp[person_redcap2omop_map['person_source_value']]).first
        puts person.inspect
        if person.present?
          domain_redcap_variable_choice_maps.each do |domain_redcap_variable_choice_map|
            puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name.inspect
            puts domain_redcap_variable_choice_map.redcap_variable_choice.choice_description
            puts redcap_export_tmp.inspect

            filter_out = redcap_project.complete_instrument && redcap_export_tmp["#{domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.form_name}_complete"].to_i != RedcapDataDictionary::INSTRUMENT_COMPLETE_STATUS
            puts 'filtering out' if filter_out
            puts 'the redcap_variable_name'
            puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable_name
            puts 'the value'
            puts redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable_name]
            puts 'match'
            puts domain_redcap_variable_choice_map.redcap_variable_choice.match?(redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable_name])
            if redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable_name].present? && !filter_out && domain_redcap_variable_choice_map.redcap_variable_choice.match?(redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable_name])
              puts 'we got you'
              puts domain_redcap_variable_choice_map.inspect
              puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name
              puts domain_redcap_variable_choice_map.concept.inspect
              if redcap_project.route_to_observation
                case domain_redcap_variable_choice_map.concept.domain_id
                when 'Observation', 'Measurement', 'Metadata'
                  observation = Observation.new
                  observation.observation_id = Observation.next_id
                  observation.person_id = person.person_id
                  observation.observation_concept_id = domain_redcap_variable_choice_map.concept.concept_id
                  observation.observation_type_concept_id = RedcapProject.first.type_concept.concept_id
                  observation.observation_source_value = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name
                  case domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      observation.value_as_concept_id = value_as_concept_id
                    else
                      observation.value_as_number = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    observation.value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    observation.value_as_string = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name]
                  end
                  observation.value_source_value  = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name]

                  redcap_variable_choice = domain_redcap_variable_choice_map.redcap_variable_choice
                  redcap_variable = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable
                  redcap_variable_choice.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      # puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts observation.inspect
                  observation.build_redcap_source_link(redcap_source: redcap_variable)
                  observation.save!
                end
              else
                #Do not route to Observation
                case domain_redcap_variable_choice_map.concept.domain_id
                when 'Device'
                  puts 'we are in the device'
                  device_exposure = DeviceExposure.new
                  device_exposure.device_exposure_id = DeviceExposure.next_id
                  device_exposure.person_id = person.person_id
                  device_exposure.device_concept_id = domain_redcap_variable_choice_map.concept.concept_id
                  device_exposure.device_type_concept_id = RedcapProject.first.type_concept.concept_id
                  device_exposure.device_source_value = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name
                  redcap_variable_choice = domain_redcap_variable_choice_map.redcap_variable_choice
                  redcap_variable = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable
                  redcap_variable_choice.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      puts 'hello you'
                      puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      puts redcap_variable_child_map.redcap_variable.name
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      device_exposure.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          device_exposure.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts device_exposure.inspect
                  device_exposure.build_redcap_source_link(redcap_source: redcap_variable)
                  device_exposure.save!
                when 'Measurement'
                  measurement = Measurement.new
                  measurement.measurement_id = Measurement.next_id
                  measurement.person_id = person.person_id
                  measurement.measurement_concept_id = domain_redcap_variable_choice_map.concept.concept_id
                  measurement.measurement_type_concept_id = RedcapProject.first.type_concept.concept_id
                  measurement.measurement_source_value = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name
                  case domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      measurement.value_as_concept_id = value_as_concept_id
                    else
                      measurement.value_as_number = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    measurement.value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    #do nothing
                    #no measurement.value_as_string column
                  end
                  measurement.value_source_value  = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name]
                  redcap_variable_choice = domain_redcap_variable_choice_map.redcap_variable_choice
                  redcap_variable = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable
                  redcap_variable_choice.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      puts 'hello you'
                      puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      puts redcap_variable_child_map.redcap_variable.name
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      measurement.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          measurement.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts measurement.inspect
                  measurement.build_redcap_source_link(redcap_source: redcap_variable)
                  measurement.save!
                when 'Observation','Metadata'
                  observation = Observation.new
                  observation.observation_id = Observation.next_id
                  observation.person_id = person.person_id
                  observation.observation_concept_id = domain_redcap_variable_choice_map.concept.concept_id
                  observation.observation_type_concept_id = RedcapProject.first.type_concept.concept_id
                  observation.observation_source_value = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name
                  case domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      observation.value_as_concept_id = value_as_concept_id
                    else
                      observation.value_as_number = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_choice_map.redcap_variable_choice
                    puts domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    observation.value_as_concept_id = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    observation.value_as_string = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name]
                  end
                  observation.value_source_value  = redcap_export_tmp[domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable.name]
                  redcap_variable_choice = domain_redcap_variable_choice_map.redcap_variable_choice
                  redcap_variable = domain_redcap_variable_choice_map.redcap_variable_choice.redcap_variable
                  redcap_variable_choice.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      # puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts observation.inspect
                  observation.build_redcap_source_link(redcap_source: redcap_variable)
                  observation.save!
                end
              end
            end
          end
        end
      end

      #domain_redcap_variable
      domain_redcap_variable_maps = redcap_variables_maps_in_omop_domains(redcap_data_dictionary)
      puts 'how many domain_redcap_variable_maps'
      puts domain_redcap_variable_maps.size
      redcap_records.each do |redcap_export_tmp|
        puts redcap_export_tmp[person_redcap2omop_map['person_source_value']].inspect
        person = Person.where(person_source_value: redcap_export_tmp[person_redcap2omop_map['person_source_value']]).first
        puts person.inspect
        if person.present?
          domain_redcap_variable_maps.each do |domain_redcap_variable_map|
            puts domain_redcap_variable_map.redcap_variable.name.inspect
            puts redcap_export_tmp.inspect
            filter_out = redcap_project.complete_instrument && redcap_export_tmp["#{domain_redcap_variable_map.redcap_variable.form_name}_complete"].to_i != RedcapDataDictionary::INSTRUMENT_COMPLETE_STATUS
            puts 'filtering out' if filter_out
            if redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name].present? && !filter_out
              puts 'we got you'
              puts domain_redcap_variable_map.inspect
              puts domain_redcap_variable_map.redcap_variable.name
              puts domain_redcap_variable_map.concept.inspect
              if redcap_project.route_to_observation
                case domain_redcap_variable_map.concept.domain_id
                when 'Observation', 'Measurement', 'Metadata'
                  observation = Observation.new
                  observation.observation_id = Observation.next_id
                  observation.person_id = person.person_id
                  observation.observation_concept_id = domain_redcap_variable_map.concept.concept_id
                  observation.observation_type_concept_id = RedcapProject.first.type_concept.concept_id
                  observation.observation_source_value = domain_redcap_variable_map.redcap_variable.name
                  case domain_redcap_variable_map.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      observation.value_as_concept_id = value_as_concept_id
                    else
                      observation.value_as_number = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    observation.value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    observation.value_as_string = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name]
                  end
                  observation.value_source_value  = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name]

                  redcap_variable = domain_redcap_variable_map.redcap_variable
                  redcap_variable.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      # puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts observation.inspect
                  observation.build_redcap_source_link(redcap_source: redcap_variable)
                  observation.save!
                end
              else
                #Do not route to Observation
                case domain_redcap_variable_map.concept.domain_id
                when 'Measurement'
                  measurement = Measurement.new
                  measurement.measurement_id = Measurement.next_id
                  measurement.person_id = person.person_id
                  measurement.measurement_concept_id = domain_redcap_variable_map.concept.concept_id
                  measurement.measurement_type_concept_id = RedcapProject.first.type_concept.concept_id
                  measurement.measurement_source_value = domain_redcap_variable_map.redcap_variable.name
                  case domain_redcap_variable_map.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      measurement.value_as_concept_id = value_as_concept_id
                    else
                      measurement.value_as_number = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    measurement.value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    #do nothing
                    #no measurement.value_as_string column
                  end
                  measurement.value_source_value  = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name]
                  redcap_variable = domain_redcap_variable_map.redcap_variable
                  redcap_variable.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      puts 'hello you'
                      puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      puts redcap_variable_child_map.redcap_variable.name
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      measurement.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          measurement.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts measurement.inspect
                  measurement.build_redcap_source_link(redcap_source: redcap_variable)
                  measurement.save!
                when 'Observation','Metadata'
                  observation = Observation.new
                  observation.observation_id = Observation.next_id
                  observation.person_id = person.person_id
                  observation.observation_concept_id = domain_redcap_variable_map.concept.concept_id
                  observation.observation_type_concept_id = RedcapProject.first.type_concept.concept_id
                  observation.observation_source_value = domain_redcap_variable_map.redcap_variable.name
                  case domain_redcap_variable_map.redcap_variable.determine_field_type
                  when 'integer'
                    value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    if value_as_concept_id.present?
                      observation.value_as_concept_id = value_as_concept_id
                    else
                      observation.value_as_number = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name].to_i
                    end
                  when 'choice'
                    puts domain_redcap_variable_map.redcap_variable.inspect
                    puts domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                    observation.value_as_concept_id = domain_redcap_variable_map.redcap_variable.map_redcap_variable_choice(redcap_export_tmp)
                  when 'text'
                    observation.value_as_string = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name]
                  end
                  observation.value_source_value  = redcap_export_tmp[domain_redcap_variable_map.redcap_variable.name]
                  redcap_variable = domain_redcap_variable_map.redcap_variable
                  redcap_variable.redcap_variable_child_maps.each do |redcap_variable_child_map|
                    # puts redcap_variable_child_map.redcap_variable.name
                    if redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                      # puts redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      value = redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                      if redcap_variable_child_map.omop_column.name == 'provider_id'
                        value = Provider.where(provider_source_value: redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                      end
                      observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                    else
                      puts 'not in the same row'
                      other_redcap_export_tmps =  redcap_records.select{|record| record['redcap_event_name'] == redcap_export_tmp['redcap_event_name'] && record['redcap_repeat_instrument'].blank?}
                      if other_redcap_export_tmps.size == 1
                        other_redcap_export_tmp = other_redcap_export_tmps.first
                        if other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name].present?
                          value = other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]
                          if redcap_variable_child_map.omop_column.name == 'provider_id'
                            value = Provider.where(provider_source_value: other_redcap_export_tmp[redcap_variable_child_map.redcap_variable.name]).first.provider_id
                          end

                          observation.write_attribute(redcap_variable_child_map.omop_column.name, value)
                        end
                      else
                        # puts 'missed the event row'
                        # puts other_redcap_export_tmps.size
                      end
                    end
                  end
                  puts observation.inspect
                  observation.build_redcap_source_link(redcap_source: redcap_variable)
                  observation.save!
                end
              end
            end
          end
        end
      end
    end
  end

  def redcap_variables_by_omop_table(omop_table, redcap_data_dictionary)
    RedcapVariableMap.joins(:redcap_variable, omop_column: :omop_table).where("omop_tables.name = ?", omop_table).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id)
  end

  def redcap_variables_maps_in_omop_domains(redcap_data_dictionary)
    RedcapVariableMap.joins(:concept, :redcap_variable).where('redcap_variables.redcap_data_dictionary_id = ?', redcap_data_dictionary.id)
  end

  def redcap_variable_choice_maps_in_omop_domains(redcap_data_dictionary)
    RedcapVariableChoiceMap.not_no_matching_concept.joins('JOIN redcap_variable_choices ON redcap_variable_choice_maps.redcap_variable_choice_id = redcap_variable_choices.id JOIN redcap_variables ON redcap_variable_choices.redcap_variable_id = redcap_variables.id JOIN redcap_variable_maps ON redcap_variables.id = redcap_variable_maps.redcap_variable_id').where('redcap_variables.redcap_data_dictionary_id = ? AND redcap_variable_maps.map_type = ? AND redcap_variable_choice_maps.map_type = ?', redcap_data_dictionary.id, RedcapVariableMap::REDCAP_VARIABLE_MAP_MAP_TYPE_OMOP_CONCEPT_CHOICE, RedcapVariableChoiceMap::REDCAP_VARIABLE_CHOICE_MAP_MAP_TYPE_OMOP_CONCEPT)
  end

  def load_redcap_events(redcap_webservice, redcap_data_dictionary)
    return unless redcap_webservice.events
    redcap_webservice.events.each do |event|
      event[:redcap_data_dictionary] = redcap_data_dictionary
      RedcapEvent.create!(event)
    end
  end

  def load_redcap_variables(redcap_webservice, redcap_data_dictionary)
    metadata  = redcap_webservice.metadata
    metadata.each do |metadata_variable|
      redcap_variable = RedcapVariable.new(redcap_data_dictionary_id: redcap_data_dictionary.id)
      redcap_variable.name                  = metadata_variable['field_name']
      redcap_variable.form_name             = metadata_variable['form_name']
      redcap_variable.field_type            = metadata_variable['field_type']
      redcap_variable.text_validation_type  = metadata_variable['text_validation_type_or_show_slider_number']
      redcap_variable.field_type_normalized = redcap_variable.normalize_field_type
      redcap_variable.field_label           = metadata_variable['field_label']
      redcap_variable.choices               = metadata_variable['select_choices_or_calculations']
      redcap_variable.field_annotation      = metadata_variable['field_annotation']
      # redcap_variable.ordinal_position
      # redcap_variable.curated

      if redcap_variable.choices.present?
        redcap_variable.choices.split('|').each_with_index do |choice, i|
          choice_code, delimiter, choice_description = choice.partition(',')
          if choice_code.present?
            choice_code.strip!
          end

          if choice_description.present?
            choice_description.strip!
          end

          if redcap_variable.field_annotation.present?
            redcap_variable.field_annotation.strip!
          end

          redcap_variable.redcap_variable_choices.build(choice_code_raw: choice_code.try(:strip), choice_description: choice_description.try(:strip), vocabulary_id_raw: redcap_variable.field_annotation.try(:strip), ordinal_position: i)
        end
      end
      redcap_variable.save!
    end
  end

  def refresh_redcap_export_table(export_table_name, field_names)
    sql = generate_create_redcap_export_table_sql(export_table_name, field_names)
    ActiveRecord::Base.connection.execute "DROP TABLE IF EXISTS #{export_table_name}"
    ActiveRecord::Base.connection.execute sql
  end

  def generate_create_redcap_export_table_sql(export_table_name, field_names)
    sql = "CREATE TABLE #{export_table_name}"
    sql_fields = []
    field_names.each do |field_name|
      sql_fields << "#{field_name} VARCHAR(255)"
    end
    sql << " (#{sql_fields.join(',')})"
  end

  def load_redcap_records(export_table_name, records)
    records.each do |record|
      values = record.values.map{ |v| ActiveRecord::Base.connection.quote(v)}.join(',')
      ActiveRecord::Base.connection.exec_insert(
        "INSERT INTO #{export_table_name} (#{record.keys.join(',')}) VALUES (#{values})"
      )
    end
  end

  def map_core
    #REDCap Project: Data Migration Sandbox - Core
    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox - Core').first
    redcap_project          = RedcapProject.where(project_id: 5840).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    redcap_variables        = redcap_data_dictionary.redcap_variables

    # patient
    redcap_variable = redcap_variables.where(name: 'global_id').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'person_source_value'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'sex_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'gender_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'F').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'M').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'birthyr').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'year_of_birth'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'dob_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'birth_datetime'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'race_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'race_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'White').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '5').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Black or African American').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '3').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'American Indian or Alaska Native').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Native Hawaiian or Other Pacific Islander').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '4').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asian').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '2').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'ethnicity_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'ethnicity_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Not Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    #provider
    redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column)
    redcap_variable.save!

    #primlang
    redcap_variable = redcap_variables.where(name: 'primlang').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 English").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_EnglishUnitedStates', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Spanish").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_SpanishSpain', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Mandarin").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Cantonese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Russian").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_RussianRussia', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Japanese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_Japanese').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '8 Other primary language (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA46-8').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "9 Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #primlanx
    redcap_variable = redcap_variables.where(name: 'primlanx').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #educ
    redcap_variable = redcap_variables.where(name: 'educ').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '82590-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '99').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #mc_subject_profession
    redcap_variable = redcap_variables.where(name: 'mc_subject_profession').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '14679004', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #maristat
    redcap_variable = redcap_variables.where(name: 'maristat').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '45404-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Married").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA48-4', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Widowed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA49-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Divorced").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA51-8', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Separated").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4288-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Never married (or marriage was annulled)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA47-6', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Living as married/domestic partner").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15605-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #fu_maristat
    redcap_variable = redcap_variables.where(name: 'fu_maristat').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '45404-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Married").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA48-4', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Widowed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA49-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Divorced").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA51-8', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Separated").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4288-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Never married (or marriage was annulled)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA47-6', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Living as married/domestic partner").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15605-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #tele_maristat
    redcap_variable = redcap_variables.where(name: 'tele_maristat').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '45404-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Married").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA48-4', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Widowed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA49-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Divorced").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA51-8', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Separated").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4288-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Never married (or marriage was annulled)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA47-6', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Living as married/domestic partner").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15605-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #handed
    redcap_variable = redcap_variables.where(name: 'handed').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '57427004', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Left-handed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '87683000', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Right-handed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '46669005', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Ambidextrous").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '46669005', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #residenc
    redcap_variable = redcap_variables.where(name: 'residenc').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '334381000000106', standard_concept: 'S').first.concept_id) #Residence and accommodation circumstances
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Single- or multi-family private residence (apartment, condo, house)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA10062-0', standard_concept: 'S').first.concept_id) # Private residence
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Retirement community or independent group living").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Assisted living, adult family home, or boarding home").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Skilled nursing facility, nursing home, hospital, or hospice").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #fu_residenc
    redcap_variable = redcap_variables.where(name: 'fu_residenc').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '334381000000106', standard_concept: 'S').first.concept_id) #Residence and accommodation circumstances
    redcap_variable.save!
    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Single- or multi-family private residence (apartment, condo, house)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA10062-0', standard_concept: 'S').first.concept_id) #Private residence
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Retirement community or independent group living").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Assisted living, adult family home, or boarding home").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Skilled nursing facility, nursing home, hospital, or hospice").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #tele_residenc
    redcap_variable = redcap_variables.where(name: 'tele_residenc').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '334381000000106', standard_concept: 'S').first.concept_id) #Residence and accommodation circumstances
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Single- or multi-family private residence (apartment, condo, house)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA10062-0', standard_concept: 'S').first.concept_id) #Private residence
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Retirement community or independent group living").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Assisted living, adult family home, or boarding home").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Skilled nursing facility, nursing home, hospital, or hospice").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #livsitua
    redcap_variable = redcap_variables.where(name: 'livsitua').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '365481000', standard_concept: 'S').first.concept_id) # does not fully match
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Lives alone").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '105529008', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Lives with one other person: a spouse or partner").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '408821002', standard_concept: 'S').first.concept_id) # lives with partner
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '447051007', standard_concept: 'S').first.concept_id) # lives with spouse
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Lives with one other person: a relative, friend, or roommate").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '430793000', standard_concept: 'S').first.concept_id) # lives with roommate
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'LOINC', concept_code: 'LP97141-3').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Lives with caregiver who is not spouse/partner, relative, or friend").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '224498006', standard_concept: 'S').first.concept_id) # lives with caregiver
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Lives with a group (related or not related) in a private residence").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Lives in group home (e.g., assisted living, nursing home, convent)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #fu_livsitua
    redcap_variable = redcap_variables.where(name: 'fu_livsitua').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '365481000', standard_concept: 'S').first.concept_id) # does not fully match
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Lives alone").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '105529008', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Lives with one other person: a spouse or partner").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '408821002', standard_concept: 'S').first.concept_id) # lives with partner
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '447051007', standard_concept: 'S').first.concept_id) # lives with spouse
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Lives with one other person: a relative, friend, or roommate").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '430793000', standard_concept: 'S').first.concept_id) # lives with roommate
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'LOINC', concept_code: 'LP97141-3').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Lives with caregiver who is not spouse/partner, relative, or friend").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '224498006', standard_concept: 'S').first.concept_id) # lives with caregiver
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Lives with a group (related or not related) in a private residence").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Lives in group home (e.g., assisted living, nursing home, convent)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #tele_livsitua
    redcap_variable = redcap_variables.where(name: 'tele_livsitua').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '365481000', standard_concept: 'S').first.concept_id) # does not fully match
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Lives alone").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '105529008', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Lives with one other person: a spouse or partner").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '408821002', standard_concept: 'S').first.concept_id) # lives with partner
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '447051007', standard_concept: 'S').first.concept_id) # lives with spouse
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Lives with one other person: a relative, friend, or roommate").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '430793000', standard_concept: 'S').first.concept_id) # lives with roommate
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'LOINC', concept_code: 'LP97141-3').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Lives with caregiver who is not spouse/partner, relative, or friend").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '224498006', standard_concept: 'S').first.concept_id) # lives with caregiver
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Lives with a group (related or not related) in a private residence").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Lives in group home (e.g., assisted living, nursing home, convent)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_subject_driving
    redcap_variable = redcap_variables.where(name: 'mc_ivp_subject_driving').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '129060000', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "8 Never drove").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15728-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_fu_subject_driving
    redcap_variable = redcap_variables.where(name: 'mc_fu_subject_driving').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '129060000', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "8 Never drove").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15728-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_tele_subject_driving
    redcap_variable = redcap_variables.where(name: 'mc_tele_subject_driving').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '129060000', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "8 Never drove").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15728-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_stop_driving
    redcap_variable = redcap_variables.where(name: 'mc_ivp_stop_driving').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_fu_stop_driving
    redcap_variable = redcap_variables.where(name: 'mc_fu_stop_driving').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_tele_stop_driving
    redcap_variable = redcap_variables.where(name: 'mc_tele_stop_driving').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_car_accident
    redcap_variable = redcap_variables.where(name: 'mc_ivp_car_accident').first
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id) # Patient lives with other person
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_fu_car_accident
    redcap_variable = redcap_variables.where(name: 'mc_fu_car_accident').first
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id) # Patient lives with other person
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id) # Patient lives with other person
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_tele_car_accident
    redcap_variable = redcap_variables.where(name: 'mc_tele_car_accident').first
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id) # Patient lives with other person
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_number_accidents
    redcap_variable = redcap_variables.where(name: 'mc_ivp_number_accidents').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_fu_number_accidents
    redcap_variable = redcap_variables.where(name: 'mc_fu_number_accidents').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'fu_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_tele_number_accidents
    redcap_variable = redcap_variables.where(name: 'mc_tele_number_accidents').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_formdate_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'tele_netid_a1').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!
  end

  def map_ppa
    #REDCap Project: Data Migration Sandbox -- PPA
    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox -- PPA').first
    redcap_project          = RedcapProject.where(project_id: 5843).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    redcap_variables        = redcap_data_dictionary.redcap_variables

    redcap_variable = redcap_variables.where(name: 'global_id').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'person_source_value'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'sex_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'gender_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'F').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'M').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'dob_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'birth_datetime'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'race_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'race_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'White').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '5').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Black or African American').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '3').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'American Indian or Alaska Native').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Native Hawaiian or Other Pacific Islander').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '4').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asian').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '2').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'ethnicity_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'ethnicity_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Not Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    #provider
    redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column)
    redcap_variable.save!

    #primlang
    redcap_variable = redcap_variables.where(name: 'primlang').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 English").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_EnglishUnitedStates', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Spanish").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_SpanishSpain', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Mandarin").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Cantonese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Russian").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_RussianRussia', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Japanese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_Japanese').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '8 Other primary language (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA46-8').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "9 Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #primlangx
    redcap_variable = redcap_variables.where(name: 'primlanx').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #educ
    redcap_variable = redcap_variables.where(name: 'educ').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '82590-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '99').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #highestdegree_patient
    redcap_variable = redcap_variables.where(name: 'highestdegree_patient').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '82589-3', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #mc_subject_profession
    redcap_variable = redcap_variables.where(name: 'mc_subject_profession').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '14679004', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #maristat
    redcap_variable = redcap_variables.where(name: 'maristat').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '45404-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Married").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA48-4', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Widowed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA49-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Divorced").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA51-8', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Separated").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4288-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Never married (or marriage was annulled)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA47-6', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Living as married/domestic partner").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15605-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'visit_date_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid_summary').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!


    # edinburghhandedness
    # redcap_variable = redcap_variables.where(name: 'edinburghhandedness').first
    # redcap_variable.redcap_variable_maps.build(concept_id: 0)
    # redcap_variable.save!
    #
    # other_redcap_variable = redcap_variables.where(name: 'ivp_formdate_a1_temp').first
    # omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    # redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    # redcap_variable.save!
    #
    # other_redcap_variable = redcap_variables.where(name: 'netid_1').first
    # omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    # redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    # redcap_variable.save!
  end

  def map_sa
    #REDCap Project: Data Migration Sandbox - SA
    # redcap_project          = RedcapProject.where(name: 'Data Migration Sandbox - SA').first
    redcap_project          = RedcapProject.where(project_id: 5844).first
    redcap_data_dictionary  = RedcapDataDictionary.find(redcap_project.redcap_data_dictionaries.maximum(:id))
    redcap_variables        = redcap_data_dictionary.redcap_variables

    # patient
    redcap_variable = redcap_variables.where(name: 'global_id').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'person_source_value'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'sex_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'gender_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Female').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'F').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Male').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Gender', concept_code: 'M').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'dob_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'birth_datetime'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable = redcap_variables.where(name: 'race_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'race_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'White').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '5').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Black or African American').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '3').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'American Indian or Alaska Native').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Native Hawaiian or Other Pacific Islander').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '4').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Asian').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Race', concept_code: '2').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Other (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable = redcap_variables.where(name: 'ethnicity_stub').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'person' AND omop_columns.name = 'ethnicity_concept_id'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Not Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Not Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Hispanic').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Ethnicity', concept_code: 'Hispanic').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: 'Prefer not to answer').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    #provider
    redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column       = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_source_value'").first
    other_omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'provider' AND omop_columns.name = 'provider_name'").first
    redcap_variable.redcap_variable_maps.build(omop_column_id: omop_column.id)
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: redcap_variable, omop_column: other_omop_column)
    redcap_variable.save!

    #primlang
    redcap_variable = redcap_variables.where(name: 'primlang').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 English").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_EnglishUnitedStates', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Spanish").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_SpanishSpain', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Mandarin").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Cantonese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_ChineseHongKong', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Russian").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_RussianRussia', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Japanese").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'SpokenWrittenLanguage_Japanese').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '8 Other primary language (specify)').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA46-8').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "9 Unknown").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #primlangx
    redcap_variable = redcap_variables.where(name: 'primlanx').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: 'Language_SpokenWrittenLanguage', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #educ
    redcap_variable = redcap_variables.where(name: 'educ').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '82590-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '99').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #highestdegree_patient
    redcap_variable = redcap_variables.where(name: 'highestdegree_patient').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '82589-3', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #mc_subject_profession
    redcap_variable = redcap_variables.where(name: 'mc_subject_profession').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '14679004', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #maristat
    redcap_variable = redcap_variables.where(name: 'maristat').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', concept_code: '45404-1', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Married").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA48-4', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Widowed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA49-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Divorced").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA51-8', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Separated").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4288-2', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Never married (or marriage was annulled)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA47-6', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Living as married/domestic partner").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15605-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #handed
    redcap_variable = redcap_variables.where(name: 'handed').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '57427004', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Left-handed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '87683000', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Right-handed").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '46669005', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Ambidextrous").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Condition', vocabulary_id: 'SNOMED', concept_code: '46669005', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #residenc
    redcap_variable = redcap_variables.where(name: 'residenc').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '334381000000106', standard_concept: 'S').first.concept_id) #Residence and accommodation circumstances
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Single- or multi-family private residence (apartment, condo, house)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA10062-0', standard_concept: 'S').first.concept_id) # Private residence
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Retirement community or independent group living").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Assisted living, adult family home, or boarding home").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Skilled nursing facility, nursing home, hospital, or hospice").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    #livsitua
    redcap_variable = redcap_variables.where(name: 'livsitua').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '365481000', standard_concept: 'S').first.concept_id) # does not fully match
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Lives alone").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '105529008', standard_concept: 'S').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "2 Lives with one other person: a spouse or partner").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '408821002', standard_concept: 'S').first.concept_id) # lives with partner
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '447051007', standard_concept: 'S').first.concept_id) # lives with spouse
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "3 Lives with one other person: a relative, friend, or roommate").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '430793000', standard_concept: 'S').first.concept_id) # lives with roommate
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'LOINC', concept_code: 'LP97141-3').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "4 Lives with caregiver who is not spouse/partner, relative, or friend").first
    # redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '224498006', standard_concept: 'S').first.concept_id) # lives with caregiver
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "5 Lives with a group (related or not related) in a private residence").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "6 Lives in group home (e.g., assisted living, nursing home, convent)").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_subject_driving
    redcap_variable = redcap_variables.where(name: 'mc_ivp_subject_driving').first
    redcap_variable.redcap_variable_maps.build(concept_id: Concept.where(domain_id: 'Observation', vocabulary_id: 'SNOMED', concept_code: '129060000', standard_concept: 'S').first.concept_id)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "8 Never drove").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA15728-1').first.concept_id)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_stop_driving
    redcap_variable = redcap_variables.where(name: 'mc_ivp_stop_driving').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_car_accident
    redcap_variable = redcap_variables.where(name: 'mc_ivp_car_accident').first
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "0 No").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA32-8').first.concept_id) # Patient lives with other person
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: "1 Yes").first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA33-6').first.concept_id) # Patient lives with other person
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: 0)
    redcap_variable_choice.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '9 Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    # mc_ivp_number_accidents
    redcap_variable = redcap_variables.where(name: 'mc_ivp_number_accidents').first
    redcap_variable.field_type_curated = 'integer'
    redcap_variable.redcap_variable_maps.build(concept_id: 0)
    redcap_variable.save!

    redcap_variable_choice = redcap_variable.redcap_variable_choices.where(choice_description: '999 = Unknown').first
    redcap_variable_choice.build_redcap_variable_choice_map(concept_id: Concept.where(domain_id: 'Meas Value', vocabulary_id: 'LOINC', concept_code: 'LA4489-6').first.concept_id)
    redcap_variable_choice.save!

    other_redcap_variable = redcap_variables.where(name: 'date_visit').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'observation_date'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!

    other_redcap_variable = redcap_variables.where(name: 'netid').first
    omop_column = OmopColumn.joins(:omop_table).where("omop_tables.name = 'observation' AND omop_columns.name = 'provider_id'").first
    redcap_variable.redcap_variable_child_maps.build(redcap_variable: other_redcap_variable, omop_column: omop_column)
    redcap_variable.save!
  end
end
